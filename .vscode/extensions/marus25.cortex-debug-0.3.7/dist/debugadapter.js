module.exports=function(e){var t={};function s(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=21)}([function(e,t){e.exports=require("events")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("fs")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(12);!function(e){e[e.Auto=0]="Auto",e[e.Hexidecimal=1]="Hexidecimal",e[e.Decimal=2]="Decimal",e[e.Binary=3]="Binary"}(t.NumberFormat||(t.NumberFormat={}));t.AdapterOutputEvent=class extends r.Event{constructor(e,t){super("adapter-output",{content:e,type:t})}};t.StoppedEvent=class extends r.Event{constructor(e,t,s){super("stopped",{reason:e,threadId:t,allThreadsStopped:s})}};t.SWOConfigureEvent=class extends r.Event{constructor(e){super("swo-configure",e)}};t.TelemetryEvent=class extends r.Event{constructor(e,t,s,r={}){super("record-event",{category:e,action:t,label:s,parameters:r})}},t.calculatePortMask=function(e){if(!e)return 0;let t=0;return e.forEach(e=>{if("advanced"===e.type)for(const s of e.ports)t=(t|1<<s)>>>0;else t=(t|1<<e.port)>>>0}),t},t.createPortName=function(e,t="gdbPort"){return t+(0===e?"":e.toString())}},function(e,t){e.exports=require("child_process")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=/^[0-7]{3}/;class n{static valueOf(e,t){if(!e)return;const s=/^\.?([a-zA-Z_\-][a-zA-Z0-9_\-]*)/,r=/^\[(\d+)\](?:$|\.)/;if(!(t=t.trim()))return e;let n=e;do{let e=s.exec(t);if(e){if(t=t.substr(e[0].length),!n.length||"string"==typeof n)return;{const t=[];for(const s of n)s[0]===e[1]&&t.push(s[1]);if(t.length>1)n=t;else{if(1!==t.length)return;n=t[0]}}}else if("@"===t[0])n=[n],t=t.substr(1);else{if(!(e=r.exec(t)))return;{t=t.substr(e[0].length);const s=parseInt(e[1]);if(n.length&&"string"!=typeof n&&s>=0&&s<n.length)n=n[s];else if(0!==s)return}}t=t.trim()}while(t);return n}constructor(e,t,s){this.token=e,this.outOfBandRecord=t,this.resultRecords=s}record(e){if(this.outOfBandRecord)return n.valueOf(this.outOfBandRecord[0].output,e)}result(e){if(this.resultRecords)return n.valueOf(this.resultRecords.results,e)}}t.MINode=n;const i=/^(?:(\d*|undefined)([\*\+\=])|([\~\@\&]))/,o=/^(\d*)\^(done|running|connected|error|exit)/,a=/^\r\n?/,c=/^([a-zA-Z_\-][a-zA-Z0-9_\-]*)/,u=/^(.*?),/;t.parseMI=function(e){let t;const s=[];let l;const d={"*":"exec","+":"status","=":"notify"},h={"~":"console","@":"target","&":"log"},p=()=>{if('"'!==e[0])return"";let t,s=1,n=!0,i=e.substr(1),o=!1;for(;n;)o?o=!1:"\\"===i[0]?o=!0:'"'===i[0]&&(n=!1),i=i.substr(1),s++;try{t=function(e){const t=Buffer.alloc(4*e.length);let s=0;if('"'!==e[0]||'"'!==e[e.length-1])throw new Error("Not a valid string");e=e.slice(1,-1);let n=!1;for(let i=0;i<e.length;i++)if(n){let o;"\\"===e[i]?s+=t.write("\\",s):'"'===e[i]?s+=t.write('"',s):"'"===e[i]?s+=t.write("'",s):"n"===e[i]?s+=t.write("\n",s):"r"===e[i]?s+=t.write("\r",s):"t"===e[i]?s+=t.write("\t",s):"b"===e[i]?s+=t.write("\b",s):"f"===e[i]?s+=t.write("\f",s):"v"===e[i]?s+=t.write("\v",s):"0"===e[i]?s+=t.write("\0",s):(o=r.exec(e.substr(i)))?(t.writeUInt8(parseInt(o[0],8),s++),i+=2):s+=t.write(e[i],s),n=!1}else if("\\"===e[i])n=!0;else{if('"'===e[i])throw new Error("Not a valid string");s+=t.write(e[i],s)}return t.slice(0,s).toString("utf8")}(e.substr(0,s))}catch(r){t=e.substr(0,s)}return e=e.substr(s),t};let f,m,g,b,v;for(f=()=>'"'===e[0]?p():"{"===e[0]||"["===e[0]?(()=>{if("{"!==e[0]&&"["!==e[0])return;const t="["===e[0];if("}"===(e=e.substr(1))[0]||"]"===e[0])return e=e.substr(1),[];if(t){let t=f();if(t){const s=[];for(s.push(t);void 0!==(t=g());)s.push(t);return e=e.substr(1),s}}let s=b();if(s){const t=[];for(t.push(s);s=m();)t.push(s);return e=e.substr(1),t}e=(t?"[":"{")+e})():void 0,b=()=>{const t=c.exec(e);if(t)return e=e.substr(t[0].length+1),[t[1],f()]},g=()=>{if(","===e[0])return e=e.substr(1),f()},m=()=>{if(","===e[0])return e=e.substr(1),b()};v=i.exec(e);){if(e=e.substr(v[0].length),v[1]&&void 0===t&&"undefined"!==v[1]&&(t=parseInt(v[1])),v[2]){const t=u.exec(e);e=e.substr(t[1].length);const r={isStream:!1,type:d[v[2]],asyncClass:t[1],output:[]};let n;for(;n=m();)r.output.push(n);s.push(r)}else if(v[3]){const e={isStream:!0,type:h[v[3]],content:p()};s.push(e)}e=e.replace(a,"")}if(v=o.exec(e)){let s;for(e=e.substr(v[0].length),v[1]&&void 0===t&&(t=parseInt(v[1])),l={resultClass:v[2],results:[]};s=m();)l.results.push(s);e=e.replace(a,"")}return new n(t,s||[],l)}},function(e,t,s){e.exports=s(43)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(22),n=s(9),i=s(10),o=s(23);t.Source=class{constructor(e,t,s=0,r,n){this.name=e,this.path=t,this.sourceReference=s,r&&(this.origin=r),n&&(this.adapterData=n)}};t.Scope=class{constructor(e,t,s=!1){this.name=e,this.variablesReference=t,this.expensive=s}};t.StackFrame=class{constructor(e,t,s,r=0,n=0){this.id=e,this.source=s,this.line=r,this.column=n,this.name=t}};t.Thread=class{constructor(e,t){this.id=e,this.name=t||"Thread #"+e}};t.Variable=class{constructor(e,t,s=0,r,n){this.name=e,this.value=t,this.variablesReference=s,"number"==typeof n&&(this.namedVariables=n),"number"==typeof r&&(this.indexedVariables=r)}};t.Breakpoint=class{constructor(e,t,s,r){this.verified=e;const n=this;"number"==typeof t&&(n.line=t),"number"==typeof s&&(n.column=s),r&&(n.source=r)}};t.Module=class{constructor(e,t){this.id=e,this.name=t}};t.CompletionItem=class{constructor(e,t,s=0){this.label=e,this.start=t,this.length=s}};t.StoppedEvent=class extends n.Event{constructor(e,t,s){super("stopped"),this.body={reason:e},"number"==typeof t&&(this.body.threadId=t),"string"==typeof s&&(this.body.text=s)}};t.ContinuedEvent=class extends n.Event{constructor(e,t){super("continued"),this.body={threadId:e},"boolean"==typeof t&&(this.body.allThreadsContinued=t)}};t.InitializedEvent=class extends n.Event{constructor(){super("initialized")}};t.TerminatedEvent=class extends n.Event{constructor(e){super("terminated"),("boolean"==typeof e||e)&&(this.body={restart:e})}};t.OutputEvent=class extends n.Event{constructor(e,t="console",s){super("output"),this.body={category:t,output:e},void 0!==s&&(this.body.data=s)}};t.ThreadEvent=class extends n.Event{constructor(e,t){super("thread"),this.body={reason:e,threadId:t}}};t.BreakpointEvent=class extends n.Event{constructor(e,t){super("breakpoint"),this.body={reason:e,breakpoint:t}}};t.ModuleEvent=class extends n.Event{constructor(e,t){super("module"),this.body={reason:e,module:t}}};t.LoadedSourceEvent=class extends n.Event{constructor(e,t){super("loadedSource"),this.body={reason:e,source:t}}};var a;t.CapabilitiesEvent=class extends n.Event{constructor(e){super("capabilities"),this.body={capabilities:e}}},function(e){e[e.User=1]="User",e[e.Telemetry=2]="Telemetry"}(a=t.ErrorDestination||(t.ErrorDestination={}));class c extends r.ProtocolServer{constructor(e,t){super();const s="boolean"==typeof e&&e;this._debuggerLinesStartAt1=s,this._debuggerColumnsStartAt1=s,this._debuggerPathsAreURIs=!1,this._clientLinesStartAt1=!0,this._clientColumnsStartAt1=!0,this._clientPathsAreURIs=!1,this._isServer="boolean"==typeof t&&t,this.on("close",()=>{this.shutdown()}),this.on("error",e=>{this.shutdown()})}setDebuggerPathFormat(e){this._debuggerPathsAreURIs="path"!==e}setDebuggerLinesStartAt1(e){this._debuggerLinesStartAt1=e}setDebuggerColumnsStartAt1(e){this._debuggerColumnsStartAt1=e}setRunAsServer(e){this._isServer=e}static run(e){let t=0;if(process.argv.slice(2).forEach(function(e,s,r){const n=/^--server=(\d{4,5})$/.exec(e);n&&(t=parseInt(n[1],10))}),t>0)console.error(`waiting for debug protocol on port ${t}`),i.createServer(t=>{console.error(">> accepted connection from client"),t.on("end",()=>{console.error(">> client connection closed\n")});const s=new e(!1,!0);s.setRunAsServer(!0),s.start(t,t)}).listen(t);else{const t=new e(!1);process.on("SIGTERM",()=>{t.shutdown()}),t.start(process.stdin,process.stdout)}}shutdown(){this._isServer||setTimeout(()=>{process.exit(0)},100)}sendErrorResponse(e,t,s,r,n=a.User){let i;"number"==typeof t?(i={id:t,format:s},r&&(i.variables=r),n&a.User&&(i.showUser=!0),n&a.Telemetry&&(i.sendTelemetry=!0)):i=t,e.success=!1,e.message=c.formatPII(i.format,!0,i.variables),e.body||(e.body={}),e.body.error=i,this.sendResponse(e)}runInTerminalRequest(e,t,s){this.sendRequest("runInTerminal",e,t,s)}dispatchRequest(e){const t=new n.Response(e);try{if("initialize"===e.command){var s=e.arguments;if("boolean"==typeof s.linesStartAt1&&(this._clientLinesStartAt1=s.linesStartAt1),"boolean"==typeof s.columnsStartAt1&&(this._clientColumnsStartAt1=s.columnsStartAt1),"path"!==s.pathFormat)this.sendErrorResponse(t,2018,"debug adapter only supports native paths",null,a.Telemetry);else{const e=t;e.body={},this.initializeRequest(e,s)}}else"launch"===e.command?this.launchRequest(t,e.arguments):"attach"===e.command?this.attachRequest(t,e.arguments):"disconnect"===e.command?this.disconnectRequest(t,e.arguments):"terminate"===e.command?this.terminateRequest(t,e.arguments):"restart"===e.command?this.restartRequest(t,e.arguments):"setBreakpoints"===e.command?this.setBreakPointsRequest(t,e.arguments):"setFunctionBreakpoints"===e.command?this.setFunctionBreakPointsRequest(t,e.arguments):"setExceptionBreakpoints"===e.command?this.setExceptionBreakPointsRequest(t,e.arguments):"configurationDone"===e.command?this.configurationDoneRequest(t,e.arguments):"continue"===e.command?this.continueRequest(t,e.arguments):"next"===e.command?this.nextRequest(t,e.arguments):"stepIn"===e.command?this.stepInRequest(t,e.arguments):"stepOut"===e.command?this.stepOutRequest(t,e.arguments):"stepBack"===e.command?this.stepBackRequest(t,e.arguments):"reverseContinue"===e.command?this.reverseContinueRequest(t,e.arguments):"restartFrame"===e.command?this.restartFrameRequest(t,e.arguments):"goto"===e.command?this.gotoRequest(t,e.arguments):"pause"===e.command?this.pauseRequest(t,e.arguments):"stackTrace"===e.command?this.stackTraceRequest(t,e.arguments):"scopes"===e.command?this.scopesRequest(t,e.arguments):"variables"===e.command?this.variablesRequest(t,e.arguments):"setVariable"===e.command?this.setVariableRequest(t,e.arguments):"setExpression"===e.command?this.setExpressionRequest(t,e.arguments):"source"===e.command?this.sourceRequest(t,e.arguments):"threads"===e.command?this.threadsRequest(t):"terminateThreads"===e.command?this.terminateThreadsRequest(t,e.arguments):"evaluate"===e.command?this.evaluateRequest(t,e.arguments):"stepInTargets"===e.command?this.stepInTargetsRequest(t,e.arguments):"gotoTargets"===e.command?this.gotoTargetsRequest(t,e.arguments):"completions"===e.command?this.completionsRequest(t,e.arguments):"exceptionInfo"===e.command?this.exceptionInfoRequest(t,e.arguments):"loadedSources"===e.command?this.loadedSourcesRequest(t,e.arguments):"dataBreakpointInfo"===e.command?this.dataBreakpointInfoRequest(t,e.arguments):"setDataBreakpoints"===e.command?this.setDataBreakpointsRequest(t,e.arguments):"readMemory"===e.command?this.readMemoryRequest(t,e.arguments):"disassemble"===e.command?this.disassembleRequest(t,e.arguments):this.customRequest(e.command,t,e.arguments)}catch(e){this.sendErrorResponse(t,1104,"{_stack}",{_exception:e.message,_stack:e.stack},a.Telemetry)}}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsRestartRequest=!1,e.body.supportsExceptionOptions=!1,e.body.supportsValueFormattingOptions=!1,e.body.supportsExceptionInfoRequest=!1,e.body.supportTerminateDebuggee=!1,e.body.supportsDelayedStackTraceLoading=!1,e.body.supportsLoadedSourcesRequest=!1,e.body.supportsLogPoints=!1,e.body.supportsTerminateThreadsRequest=!1,e.body.supportsSetExpression=!1,e.body.supportsTerminateRequest=!1,e.body.supportsDataBreakpoints=!1,e.body.supportsReadMemoryRequest=!1,e.body.supportsDisassembleRequest=!1,this.sendResponse(e)}disconnectRequest(e,t){this.sendResponse(e),this.shutdown()}launchRequest(e,t){this.sendResponse(e)}attachRequest(e,t){this.sendResponse(e)}terminateRequest(e,t){this.sendResponse(e)}restartRequest(e,t){this.sendResponse(e)}setBreakPointsRequest(e,t){this.sendResponse(e)}setFunctionBreakPointsRequest(e,t){this.sendResponse(e)}setExceptionBreakPointsRequest(e,t){this.sendResponse(e)}configurationDoneRequest(e,t){this.sendResponse(e)}continueRequest(e,t){this.sendResponse(e)}nextRequest(e,t){this.sendResponse(e)}stepInRequest(e,t){this.sendResponse(e)}stepOutRequest(e,t){this.sendResponse(e)}stepBackRequest(e,t){this.sendResponse(e)}reverseContinueRequest(e,t){this.sendResponse(e)}restartFrameRequest(e,t){this.sendResponse(e)}gotoRequest(e,t){this.sendResponse(e)}pauseRequest(e,t){this.sendResponse(e)}sourceRequest(e,t){this.sendResponse(e)}threadsRequest(e){this.sendResponse(e)}terminateThreadsRequest(e,t){this.sendResponse(e)}stackTraceRequest(e,t){this.sendResponse(e)}scopesRequest(e,t){this.sendResponse(e)}variablesRequest(e,t){this.sendResponse(e)}setVariableRequest(e,t){this.sendResponse(e)}setExpressionRequest(e,t){this.sendResponse(e)}evaluateRequest(e,t){this.sendResponse(e)}stepInTargetsRequest(e,t){this.sendResponse(e)}gotoTargetsRequest(e,t){this.sendResponse(e)}completionsRequest(e,t){this.sendResponse(e)}exceptionInfoRequest(e,t){this.sendResponse(e)}loadedSourcesRequest(e,t){this.sendResponse(e)}dataBreakpointInfoRequest(e,t){this.sendResponse(e)}setDataBreakpointsRequest(e,t){this.sendResponse(e)}readMemoryRequest(e,t){this.sendResponse(e)}disassembleRequest(e,t){this.sendResponse(e)}customRequest(e,t,s){this.sendErrorResponse(t,1014,"unrecognized request",null,a.Telemetry)}convertClientLineToDebugger(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e+1:this._clientLinesStartAt1?e-1:e}convertDebuggerLineToClient(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e-1:this._clientLinesStartAt1?e+1:e}convertClientColumnToDebugger(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e+1:this._clientColumnsStartAt1?e-1:e}convertDebuggerColumnToClient(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e-1:this._clientColumnsStartAt1?e+1:e}convertClientPathToDebugger(e){return this._clientPathsAreURIs!==this._debuggerPathsAreURIs?this._clientPathsAreURIs?c.uri2path(e):c.path2uri(e):e}convertDebuggerPathToClient(e){return this._debuggerPathsAreURIs!==this._clientPathsAreURIs?this._debuggerPathsAreURIs?c.uri2path(e):c.path2uri(e):e}static path2uri(e){"win32"===process.platform&&(/^[A-Z]:/.test(e)&&(e=e[0].toLowerCase()+e.substr(1)),e=e.replace(/\\/g,"/")),e=encodeURI(e);let t=new o.URL("file:");return t.pathname=e,t.toString()}static uri2path(e){let t=new o.URL(e),s=decodeURIComponent(t.pathname);return"win32"===process.platform&&(/^\/[a-zA-Z]:/.test(s)&&(s=s[1].toLowerCase()+s.substr(2)),s=s.replace(/\//g,"\\")),s}static formatPII(e,t,s){return e.replace(c._formatPIIRegexp,function(e,r){return t&&r.length>0&&"_"!==r[0]?e:s[r]&&s.hasOwnProperty(r)?s[r]:e})}}c._formatPIIRegexp=/{([^}]+)}/g,t.DebugSession=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){this.seq=0,this.type=e}}t.Message=r;t.Response=class extends r{constructor(e,t){super("response"),this.request_seq=e.seq,this.command=e.command,t?(this.success=!1,this.message=t):this.success=!0}};t.Event=class extends r{constructor(e,t){super("event"),this.event=e,t&&(this.body=t)}}},function(e,t){e.exports=require("net")},function(e,t){e.exports=require("crypto")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(8);t.DebugSession=r.DebugSession,t.InitializedEvent=r.InitializedEvent,t.TerminatedEvent=r.TerminatedEvent,t.StoppedEvent=r.StoppedEvent,t.ContinuedEvent=r.ContinuedEvent,t.OutputEvent=r.OutputEvent,t.ThreadEvent=r.ThreadEvent,t.BreakpointEvent=r.BreakpointEvent,t.ModuleEvent=r.ModuleEvent,t.LoadedSourceEvent=r.LoadedSourceEvent,t.CapabilitiesEvent=r.CapabilitiesEvent,t.Thread=r.Thread,t.StackFrame=r.StackFrame,t.Scope=r.Scope,t.Variable=r.Variable,t.Breakpoint=r.Breakpoint,t.Source=r.Source,t.Module=r.Module,t.CompletionItem=r.CompletionItem,t.ErrorDestination=r.ErrorDestination;const n=s(24);t.LoggingDebugSession=n.LoggingDebugSession;const i=s(13);t.Logger=i;const o=s(9);t.Event=o.Event,t.Response=o.Response;const a=s(26);t.Handles=a.Handles;const c=i.logger;t.logger=c},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const n=s(3),i=s(1),o=s(25),a=s(8);var c;!function(e){e[e.Verbose=0]="Verbose",e[e.Log=1]="Log",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Stop=4]="Stop"}(c=t.LogLevel||(t.LogLevel={}));class u{constructor(){this._pendingLogQ=[]}log(e,t=c.Log){e+="\n",this._write(e,t)}verbose(e){this.log(e,c.Verbose)}warn(e){this.log(e,c.Warn)}error(e){this.log(e,c.Error)}dispose(){if(this._currentLogger){const e=this._currentLogger.dispose();return this._currentLogger=null,e}return Promise.resolve()}_write(e,t=c.Log){e+="",this._pendingLogQ?this._pendingLogQ.push({msg:e,level:t}):this._currentLogger&&this._currentLogger.log(e,t)}setup(e,t,s=!0){const r="string"==typeof t?t:t&&this._logFilePathFromInit;if(this._currentLogger){const t={consoleMinLogLevel:e,logFilePath:r,prependTimestamp:s};this._currentLogger.setup(t).then(()=>{if(this._pendingLogQ){const e=this._pendingLogQ;this._pendingLogQ=null,e.forEach(e=>this._write(e.msg,e.level))}})}}init(e,t,s){this._pendingLogQ=this._pendingLogQ||[],this._currentLogger=new l(e,s),this._logFilePathFromInit=t}}t.Logger=u,t.logger=new u;class l{constructor(e,t){this.beforeExitCallback=()=>this.dispose(),this._logCallback=e,this._logToConsole=t,this._minLogLevel=c.Warn,this.disposeCallback=(e,t)=>{this.dispose(),t=t||2,t+=128,process.exit(t)}}setup(e){return r(this,void 0,void 0,function*(){if(this._minLogLevel=e.consoleMinLogLevel,this._prependTimestamp=e.prependTimestamp,e.logFilePath)if(i.isAbsolute(e.logFilePath)){const s=t=>this.sendLog(`Error creating log file at path: ${e.logFilePath}. Error: ${t.toString()}\n`,c.Error);try{yield(t=i.dirname(e.logFilePath),new Promise((e,s)=>{o(t,t=>{t?s(t):e()})})),this.log("Verbose logs are written to:\n",c.Warn),this.log(e.logFilePath+"\n",c.Warn),this._logFileStream=n.createWriteStream(e.logFilePath),this.logDateTime(),this.setupShutdownListeners(),this._logFileStream.on("error",e=>{s(e)})}catch(e){s(e)}}else this.log(`logFilePath must be an absolute path: ${e.logFilePath}`,c.Error);var t})}logDateTime(){let e=new Date;const t=e.getUTCFullYear()+"-"+`${e.getUTCMonth()+1}`+"-"+e.getUTCDate()+", "+p();this.log(t+"\n",c.Verbose,!1)}setupShutdownListeners(){process.addListener("beforeExit",this.beforeExitCallback),process.addListener("SIGTERM",this.disposeCallback),process.addListener("SIGINT",this.disposeCallback)}removeShutdownListeners(){process.removeListener("beforeExit",this.beforeExitCallback),process.removeListener("SIGTERM",this.disposeCallback),process.removeListener("SIGINT",this.disposeCallback)}dispose(){return new Promise(e=>{this.removeShutdownListeners(),this._logFileStream?(this._logFileStream.end(e),this._logFileStream=null):e()})}log(e,t,s=!0){if(this._minLogLevel!==c.Stop){if(t>=this._minLogLevel&&this.sendLog(e,t),this._logToConsole){const s=t===c.Error?console.error:t===c.Warn?console.warn:null;s&&s(h(e))}t===c.Error&&(e=`[${c[t]}] ${e}`),this._prependTimestamp&&s&&(e="["+p()+"] "+e),this._logFileStream&&this._logFileStream.write(e)}}sendLog(e,t){if(e.length>1500){const t=!!e.match(/(\n|\r\n)$/);e=e.substr(0,1500)+"[...]",t&&(e+="\n")}if(this._logCallback){const s=new d(e,t);this._logCallback(s)}}}class d extends a.OutputEvent{constructor(e,t){super(e,t===c.Error?"stderr":t===c.Warn?"console":"stdout")}}function h(e){return e.replace(/(\n|\r\n)$/,"")}function p(){let e=new Date;return f(2,String(e.getUTCHours()))+":"+f(2,String(e.getUTCMinutes()))+":"+f(2,String(e.getUTCSeconds()))+"."+f(3,String(e.getUTCMilliseconds()))+" UTC"}function f(e,t){return t.length>=e?t:String("0".repeat(e)+t).slice(-e)}t.LogOutputEvent=d,t.trimLastNewline=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6);t.VariableObject=class{constructor(e){this.name=r.MINode.valueOf(e,"name"),this.exp=r.MINode.valueOf(e,"exp"),this.numchild=parseInt(r.MINode.valueOf(e,"numchild")),this.type=r.MINode.valueOf(e,"type"),this.value=r.MINode.valueOf(e,"value"),this.threadId=r.MINode.valueOf(e,"thread-id"),this.frozen=!!r.MINode.valueOf(e,"frozen"),this.dynamic=!!r.MINode.valueOf(e,"dynamic"),this.displayhint=r.MINode.valueOf(e,"displayhint"),this.children={},this.hasMore=!!r.MINode.valueOf(e,"has_more")}applyChanges(e){this.value=r.MINode.valueOf(e,"value"),r.MINode.valueOf(e,"type_changed")&&(this.type=r.MINode.valueOf(e,"new_type")),this.dynamic=!!r.MINode.valueOf(e,"dynamic"),this.displayhint=r.MINode.valueOf(e,"displayhint"),this.hasMore=!!r.MINode.valueOf(e,"has_more")}isCompound(){return this.numchild>0||"{...}"===this.value||this.dynamic&&("array"===this.displayhint||"map"===this.displayhint)}toProtocolVariable(){const e={name:this.exp,evaluateName:this.fullExp||this.exp,value:void 0===this.value?"<unknown>":this.value,type:this.type,presentationHint:{kind:this.displayhint},variablesReference:this.id};return this.displayhint,e}},t.MIError=class{constructor(e,t){Object.defineProperty(this,"name",{get:()=>this.constructor.name}),Object.defineProperty(this,"message",{get:()=>e}),Object.defineProperty(this,"source",{get:()=>t}),Error.captureStackTrace(this,this.constructor)}toString(){return`${this.message} (from ${this.source})`}},Object.setPrototypeOf(t.MIError,Object.create(Error.prototype)),t.MIError.prototype.constructor=t.MIError},function(e,t){e.exports=require("timers")},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const n=s(30),i=s(2),o=s(10),a=s(5),c=s(7);class u{static isPortInUse(e,t){return new Promise((s,r)=>{const n=o.createServer(e=>{});n.once("error",i=>{const o=i.code;o&&"EADDRINUSE"===o||"EACCES"===o?("EACCES"===o&&console.log(`port ${t}:${e} returned code EACCES?`),s(!0)):(console.log(`port ${t}:${e} unexpected error `,i),r(i)),n.close()}),n.listen(e,t,()=>{s(!1),n.close()})})}static isPortInUseEx(e,t){if(u.shouldUseServerMethod(t)){const t=u.getLocalHostAliases();let s=0;return new Promise((r,n)=>{!function e(i,o){u.isPortInUse(i,o).then(n=>{n?r(n):++s===t.length?r(!1):e(i,t[s])}).catch(e=>{n(e)})}(e,t[s])})}return n.check(e,t)}static findFreePorts({min:e,max:t,retrieve:s=1,consecutive:r=!1,doLog:i=!1},o=u.DefaultHost){let a=[];const c=[],l=s,d=u.shouldUseServerMethod(o)?u.isPortInUseEx:n.tcpPortUsed;return new Promise((s,n)=>{l<=0?s(a):function e(o,u){const h=process.hrtime();d(o,u).then(d=>{const p=process.hrtime(h);if(d?c.push(o):(r&&a.length>0&&o!==1+a[a.length-1]&&(i&&console.log("TcpPortHelper.find: Oops, reset for consecutive ports requirement"),a=[]),a.push(o)),i){const e=(p[1]/1e6).toFixed(2),t=`${p[0]}s ${e}ms`;console.log(`TcpPortHelper.find Port ${u}:${o} `+(d?"busy":"free")+`, Found: ${a.length} of ${l} needed ${t}`)}a.length===l?s(a):o<t?e(o+1,u):n(new Error(`Only found ${a.length} of ${l} ports`))}).catch(e=>{n(e)})}(e,o)})}static findFreePortsSync({min:e,max:t,retrieve:s=1,consecutive:i=!1,doLog:o=!1},a=u.DefaultHost,c=null){return r(this,void 0,void 0,function*(){let r=[];const l=[],d=s;let h=null;if(d<=0)return new Promise(e=>{e(r)});const p=u.shouldUseServerMethod(a)?u.isPortInUseEx:n.tcpPortUsed;for(let s=e;s<=t;s++){if(d<=0)return;const e=process.hrtime();if(yield p(s,a).then(t=>{const n=process.hrtime(e);if(t?l.push(s):(i&&r.length>0&&s!==1+r[r.length-1]&&(o&&console.log("TcpPortHelper.finnd: Oops, reset for consecutive requirement"),r=[]),r.push(s)),o){const e=(n[1]/1e6).toFixed(2),i=`${n[0]}s ${e}ms`;console.log(`TcpPortHelper.find Port ${a}:${s} `+(t?"busy":"free")+`, Found: ${r.length} of ${d} needed `+i)}},e=>{o&&console.error("Error on check:",e.message),h=e}),h||r.length===d)break}return c?(h||r.length!==d||c(r),null):new Promise((e,t)=>{h||r.length!==d?t(h||`Only found ${r.length} of ${d} ports`):e(r)})})}static getOsNetProbeCmd(){if(""===u.OSNetProbeCmd){const e=c.sync,t=i.platform(),s="win32"===t,r="darwin"===t;s||r||!e("ss")?e("netstat")?(u.OSNetProbeCmd=s?"netstat -nap tcp":"netstat -nap tcp -f inet",u.OSNetProbeCmdRegexpStr="[tT][cC][pP][^\\n]*[:\\.]XYZZY\\s+[^\\s]+\\s+LISTEN[^\\n]*\\n"):r&&e("lsof")?(u.OSNetProbeCmd="lsof -n -iTCP:XYZZY -sTCP:LISTEN",u.OSNetProbeCmdRegexpStr="IPv4[^\\n]+:XYZZY\\s[^\\n]*\\(LISTEN\\)[^\\n]*\\n"):u.OSNetProbeCmd="?":(u.OSNetProbeCmd="ss -nlt",u.OSNetProbeCmdRegexpStr="LISTEN\\s+[^\\n]*:XYZZY\\s+[^\\s]+[^\\n]*\\n")}return u.OSNetProbeCmd}static waitForPortOpenOSUtl(e,t=100,s=5e3,r=!0,n=!0){const i=u.getOsNetProbeCmd().replace("XYZZY",e.toString());if(n&&console.log(i),r&&"?"===i)return u.waitForPortOpen(e,u.DefaultHost,!0,t,s);const o=u.OSNetProbeCmdRegexpStr.replace("XYZZY",e.toString());n&&console.log(o);const c=new RegExp(o),l=Date.now();let d=!0;return t=Math.max(t,1),new Promise(function e(r,o){if("?"===i)return o(new Error("failed"));a.exec(i,(a,u)=>{if(a&&!i.startsWith("lsof"))return o(a);if(c.test(u))return n&&console.log(u.match(c).join("\n")),r();{d&&(d=!1);const i=Date.now()-l;if(!(i<s))return o(new Error("timeout"));n&&console.log(`waitForPortOpenOSUtl: Setting timeout for ${t}ms, curTime = ${i}ms`),setTimeout(()=>{e(r,o)},t)}})})}static waitForPortStatusEx(e){e.startTimeMs=Date.now();const t=e.checkLocalHostAliases?u.isPortInUseEx:u.isPortInUse;return new Promise(function s(r,n){t(e.port,e.host).then(t=>{if(t===e.desiredStatus)return r();throw new Error("tryagain")}).catch(t=>{if("tryagain"!==t.message)return n(t);if(!(Date.now()-e.startTimeMs<e.timeOutMs))return n(new Error("timeout"));setTimeout(()=>{s(r,n)},e.retryTimeMs)})})}static waitForPortStatus(e,t=u.DefaultHost,s=!0,r=!0,i=100,o=5e3){if(i=Math.max(i,1),u.shouldUseServerMethod(t)){const n=new l(s,e,t,r,i,o);return u.waitForPortStatusEx(n)}return n.waitForStatus(e,t,s,i,o)}static waitForPortOpen(e,t=u.DefaultHost,s=!0,r=100,i=5e3){if(r=Math.max(r,1),u.shouldUseServerMethod(t)){const n=new l(!0,e,t,s,r,i);return u.waitForPortStatusEx(n)}return n.waitUntilUsedOnHost(e,t,r,i)}static waitForPortClosed(e,t=u.DefaultHost,s=!0,r=100,i=5e3){if(r=Math.max(r,1),u.shouldUseServerMethod(t)){const n=new l(!1,e,t,s,r,i);return u.waitForPortStatusEx(n)}return n.waitUntilFreeOnHost(e,t,r,i)}static getLocalHostAliases(){if(0===u.localHostAliases.length){u.localHostAliases=["0.0.0.0","127.0.0.1",""];const e=i.networkInterfaces();Object.keys(e).forEach(t=>{e[t].forEach(e=>{e.internal&&"ipv4"===e.family.toLowerCase()&&-1===u.localHostAliases.indexOf(e.address)&&u.localHostAliases.push(e.address)})})}return u.localHostAliases}static shouldUseServerMethod(e){return!u.ForceClientMethod&&(!e||"localhost"===e.toLowerCase()||u.getLocalHostAliases().indexOf(e)>=0)}}u.ForceClientMethod=!1,u.DefaultHost="0.0.0.0",u.OSNetProbeCmd="",u.OSNetProbeCmdRegexpStr="",u.localHostAliases=[],t.TcpPortScanner=u;class l{constructor(e,t,s=u.DefaultHost,r=!0,n=100,i=5e3){this.desiredStatus=e,this.port=t,this.host=s,this.checkLocalHostAliases=r,this.retryTimeMs=n,this.timeOutMs=i,this.startTimeMs=0,this.retryTimeMs=Math.max(this.retryTimeMs,1)}}t.PortStatusArgs=l},function(e,t){e.exports=require("util")},function(e,t,s){e.exports=function(e){function t(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e.charCodeAt(s),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){let s;function o(...e){if(!o.enabled)return;const t=o,n=Number(new Date),i=n-(s||n);t.diff=i,t.prev=s,t.curr=n,s=n,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(s,n)=>{if("%%"===s)return s;a++;const i=r.formatters[n];if("function"==typeof i){const r=e[a];s=i.call(t,r),e.splice(a,1),a--}return s}),r.formatArgs.call(t,e),(t.log||r.log).apply(t,e)}return o.namespace=e,o.enabled=r.enabled(e),o.useColors=r.useColors(),o.color=t(e),o.destroy=n,o.extend=i,"function"==typeof r.init&&r.init(o),r.instances.push(o),o}function n(){const e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}function i(e,t){return r(this.namespace+(void 0===t?":":t)+e)}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){const e=[...r.names.map(o),...r.skips.map(o).map(e=>"-"+e)].join(",");return r.enable(""),e},r.enable=function(e){let t;r.save(e),r.names=[],r.skips=[];const s=("string"==typeof e?e:"").split(/[\s,]+/),n=s.length;for(t=0;t<n;t++)s[t]&&("-"===(e=s[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")));for(t=0;t<r.instances.length;t++){const e=r.instances[t];e.enabled=r.enabled(e.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;let t,s;for(t=0,s=r.skips.length;t<s;t++)if(r.skips[t].test(e))return!1;for(t=0,s=r.names.length;t<s;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=s(38),Object.keys(e).forEach(t=>{r[t]=e[t]}),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},function(e,t,s){
/*!
 * Tmp
 *
 * Copyright (c) 2011-2017 KARASZI Istvan <github@spam.raszi.hu>
 *
 * MIT Licensed
 */
const r=s(3),n=s(1),i=s(11),o=s(49),a=process.binding("constants"),c=o(),u="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",l=/XXXXXX/,d=3,h=(a.O_CREAT||a.fs.O_CREAT)|(a.O_EXCL||a.fs.O_EXCL)|(a.O_RDWR||a.fs.O_RDWR),p=a.EBADF||a.os.errno.EBADF,f=a.ENOENT||a.os.errno.ENOENT,m=448,g=384,b=[];var v=!1,y=!1;function C(e){var t=[],s=null;try{s=i.randomBytes(e)}catch(t){s=i.pseudoRandomBytes(e)}for(var r=0;r<e;r++)t.push(u[s[r]%u.length]);return t.join("")}function S(e){return void 0===e}function x(e,t){return"function"==typeof e?[t||{},e]:S(e)?[{},t]:[e,t]}function E(e){if(e.name)return n.join(e.dir||c,e.name);if(e.template)return e.template.replace(l,C(6));const t=[e.prefix||"tmp-",process.pid,C(12),e.postfix||""].join("");return n.join(e.dir||c,t)}function R(e,t){var s=x(e,t),n=s[0],i=s[1],o=n.name?1:n.tries||d;return isNaN(o)||o<0?i(new Error("Invalid tries")):n.template&&!n.template.match(l)?i(new Error("Invalid template provided")):void function e(){const t=E(n);r.stat(t,function(s){if(!s)return o-- >0?e():i(new Error("Could not get a unique tmp filename, max tries reached "+t));i(null,t)})}()}function w(e){var t=x(e)[0],s=t.name?1:t.tries||d;if(isNaN(s)||s<0)throw new Error("Invalid tries");if(t.template&&!t.template.match(l))throw new Error("Invalid template provided");do{const e=E(t);try{r.statSync(e)}catch(t){return e}}while(s-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function O(e){const t=[e];do{for(var s=t.pop(),i=!1,o=r.readdirSync(s),a=0,c=o.length;a<c;a++){var u=n.join(s,o[a]);r.lstatSync(u).isDirectory()?(i||(i=!0,t.push(s)),t.push(u)):r.unlinkSync(u)}i||r.rmdirSync(s)}while(0!==t.length)}function T(e,t,s){const n=I(function(e){try{0<=e[0]&&r.closeSync(e[0])}catch(e){if(!A(e,-p,"EBADF")&&!F(e))throw e}try{r.unlinkSync(e[1])}catch(e){if(!F(e))throw e}},[t,e]);return s.keep||b.unshift(n),n}function P(e,t){const s=I(t.unsafeCleanup?O:r.rmdirSync.bind(r),e);return t.keep||b.unshift(s),s}function I(e,t){var s=!1;return function r(n){if(!s){const n=b.indexOf(r);n>=0&&b.splice(n,1),s=!0,e(t)}n&&n(null)}}function M(){if(!y||v)for(;b.length;)try{b[0].call(null)}catch(e){}}function F(e){return A(e,-f,"ENOENT")}function A(e,t,s){return e.code==t||e.code==s}const $=process.versions.node.split(".").map(function(e){return parseInt(e,10)});0===$[0]&&($[1]<9||9===$[1]&&$[2]<5)&&process.addListener("uncaughtException",function(e){throw y=!0,M(),e}),process.addListener("exit",function(e){e&&(y=!0),M()}),e.exports.tmpdir=c,e.exports.dir=function(e,t){var s=x(e,t),n=s[0],i=s[1];R(n,function(e,t){if(e)return i(e);r.mkdir(t,n.mode||m,function(e){if(e)return i(e);i(null,t,P(t,n))})})},e.exports.dirSync=function(e){var t=x(e)[0];const s=w(t);return r.mkdirSync(s,t.mode||m),{name:s,removeCallback:P(s,t)}},e.exports.file=function(e,t){var s=x(e,t),n=s[0],i=s[1];n.postfix=S(n.postfix)?".tmp":n.postfix,R(n,function(e,t){if(e)return i(e);r.open(t,h,n.mode||g,function(e,s){return e?i(e):n.discardDescriptor?r.close(s,function(e){if(e){try{r.unlinkSync(t)}catch(t){F(t)||(e=t)}return i(e)}i(null,t,void 0,T(t,-1,n))}):n.detachDescriptor?i(null,t,s,T(t,-1,n)):void i(null,t,s,T(t,s,n))})})},e.exports.fileSync=function(e){var t=x(e)[0];t.postfix=t.postfix||".tmp";const s=t.discardDescriptor||t.detachDescriptor,n=w(t);var i=r.openSync(n,h,t.mode||g);return t.discardDescriptor&&(r.closeSync(i),i=void 0),{name:n,fd:i,removeCallback:T(n,s?-1:i,t)}},e.exports.tmpName=R,e.exports.tmpNameSync=w,e.exports.setGracefulCleanup=function(){v=!0}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Function=0]="Function",e[e.File=1]="File",e[e.Object=2]="Object",e[e.Normal=3]="Normal"}(t.SymbolType||(t.SymbolType={})),function(e){e[e.Local=0]="Local",e[e.Global=1]="Global",e[e.Neither=2]="Neither",e[e.Both=3]="Both"}(t.SymbolScope||(t.SymbolScope={}))},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const n=s(12),i=s(27),o=s(28),a=s(14),c=s(4),u=s(29),l=s(6),d=s(44),h=s(2),p=s(1),f=s(3),m=s(45),g=s(11),b=s(15),v=s(0),y=s(47),C=s(48),S=s(50),x=s(51),E=s(52),R=s(53),w=s(54),O=s(55),T=s(56),P=s(20),I=s(16),M={jlink:y.JLinkServerController,openocd:C.OpenOCDServerController,stutil:S.STUtilServerController,pyocd:x.PyOCDServerController,pe:R.PEServerController,bmp:E.BMPServerController,qemu:w.QEMUServerController,external:O.ExternalServerController};class F{constructor(e,t){this.name=e,this.options=t}}const A=254,$=256,D=65535,N=65536,k=131071,_=131072,L=e=>e.startsWith("-")?e.substring(1):`interpreter-exec console "${e}"`;class q extends n.Event{constructor(e,t){super("custom-stop",{reason:e,threadID:t})}}class j extends n.Event{constructor(e,t=!0){super("custom-continued",{threadID:e,allThreads:t})}}const B=!1;class U extends n.DebugSession{constructor(e,t=!1,s=1){super(e,t),this.variableHandles=new n.Handles(_),this.variableHandlesReverse={},this.forceDisassembly=!1,this.activeEditorPath=null,this.currentThreadId=0,this.activeThreadIds=new Set,this.disableSendStoppedEvents=!1,this.stopped=!1,this.stoppedReason="",this.stoppedThreadId=0,this.stoppedEventPending=!1,this.breakpointMap=new Map,this.fileExistsCache=new Map,this.onConfigDone=new v.EventEmitter,this.timeStart=Date.now(),this.floatingVariableMap={}}initDebugger(){this.miDebugger.on("launcherror",this.launchError.bind(this)),this.miDebugger.on("quit",this.quitEvent.bind(this)),this.miDebugger.on("exited-normally",this.quitEvent.bind(this)),this.miDebugger.on("stopped",this.stopEvent.bind(this)),this.miDebugger.on("msg",this.handleMsg.bind(this)),this.miDebugger.on("breakpoint",this.handleBreakpoint.bind(this)),this.miDebugger.on("step-end",this.handleBreak.bind(this)),this.miDebugger.on("step-out-end",this.handleBreak.bind(this)),this.miDebugger.on("signal-stop",this.handlePause.bind(this)),this.miDebugger.on("running",this.handleRunning.bind(this)),this.miDebugger.on("thread-created",this.handleThreadCreated.bind(this)),this.miDebugger.on("thread-exited",this.handleThreadExited.bind(this)),this.miDebugger.on("thread-selected",this.handleThreadSelected.bind(this)),this.miDebugger.on("thread-group-exited",this.handleThreadGroupExited.bind(this)),this.sendEvent(new n.InitializedEvent)}initializeRequest(e,t){e.body.supportsHitConditionalBreakpoints=!0,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsConditionalBreakpoints=!0,e.body.supportsFunctionBreakpoints=!0,e.body.supportsEvaluateForHovers=!0,e.body.supportsSetVariable=!0,e.body.supportsRestartRequest=!0,this.sendResponse(e)}launchAttachInit(e){this.args=this.normalizeArguments(e),this.args.showDevDebugOutput&&this.handleMsg("log",`Reading symbols from '${e.executable}'\n`),this.symbolTable=new T.SymbolTable(e.toolchainPath,e.toolchainPrefix,e.executable,e.demangle),this.symbolTable.loadSymbols(),this.args.showDevDebugOutput&&this.handleMsg("log","Finished reading symbols\n"),this.breakpointMap=new Map,this.fileExistsCache=new Map}dbgSymbolStuff(e,t,s,r){if("hdm"===h.userInfo().username){this.handleMsg("log",`Reading symbols from ${t}\n`);const n=new T.SymbolTable(e.toolchainPath,e.toolchainPrefix,t,!0);n.loadSymbols();let i=n.getFunctionByName(s,r);console.log(i),i=n.getFunctionByName("memset"),console.log(i),this.handleMsg("log","Finished Reading symbols\n")}}launchRequest(e,t){this.launchAttachInit(t),this.processLaunchAttachRequest(e,!1)}attachRequest(e,t){this.launchAttachInit(t),this.processLaunchAttachRequest(e,!0)}normalizeArguments(e){return e.graphConfig=e.graphConfig||[],e.executable&&!p.isAbsolute(e.executable)&&(e.executable=p.normalize(p.join(e.cwd,e.executable))),e.svdFile&&!p.isAbsolute(e.svdFile)&&(e.svdFile=p.normalize(p.join(e.cwd,e.svdFile))),e.swoConfig&&e.swoConfig.decoders&&(e.swoConfig.decoders=e.swoConfig.decoders.map(t=>("advanced"===t.type&&t.decoder&&!p.isAbsolute(t.decoder)&&(t.decoder=p.normalize(p.join(e.cwd,t.decoder))),t))),e}processLaunchAttachRequest(e,t){if(!f.existsSync(this.args.executable))return void this.sendErrorResponse(e,103,`Unable to find executable file at ${this.args.executable}.`);const s=M[this.args.servertype];this.serverController=new s,this.serverController.setArguments(this.args),this.serverController.on("event",this.serverControllerEvent.bind(this)),this.quit=!1,this.attached=!1,this.started=!1,this.crashed=!1,this.debugReady=!1,this.stopped=!1,this.activeThreadIds.clear();const r={min:5e4,max:52e3,retrieve:this.calculatePortsNeeded(),consecutive:!0};I.TcpPortScanner.findFreePorts(r,u.GDBServer.LOCALHOST).then(s=>{this.createPortsMap(s),this.serverController.setPorts(this.ports);const r=this.serverController.serverExecutable(),n=this.serverController.serverArguments();let o="win32"!==h.platform()?`${this.args.toolchainPrefix}-gdb`:`${this.args.toolchainPrefix}-gdb.exe`;if(this.args.toolchainPath&&(o=p.normalize(p.join(this.args.toolchainPath,o))),this.args.gdbpath&&(o=this.args.gdbpath),p.isAbsolute(o)){if(!1===f.existsSync(o))return void this.sendErrorResponse(e,103,`${this.serverController.name} GDB executable "${o}" was not found.\n`+'Please configure "cortex-debug.armToolchainPath" correctly.')}else if(!m.sync(o.replace(".exe","")))return void this.sendErrorResponse(e,103,`${this.serverController.name} GDB executable "${o}" was not found.\n`+'Please configure "cortex-debug.armToolchainPath" correctly.');if(r){this.handleMsg("log",`Please check OUTPUT tab (Adapter Output) for output from ${r}`+"\n");const e=`Launching server: "${r}" `+n.map(e=>'"'+e.replace(/"/g,'\\"')+'"').join(" ")+"\n";this.handleMsg("log",e)}let a=this.serverController.initMatch();this.args.overrideGDBServerStartedRegex&&(a=new RegExp(this.args.overrideGDBServerStartedRegex,"i"));const l=this.ports[c.createPortName(this.args.targetProcessor)];this.server=new u.GDBServer(this.args.cwd,r,n,a,l),this.server.on("output",this.handleAdapterOutput.bind(this)),this.server.on("quit",()=>{this.started?this.quitEvent():this.sendErrorResponse(e,103,`${this.serverController.name} GDB Server Quit Unexpectedly. See Adapter Output for more details.`)}),this.server.on("launcherror",t=>{this.sendErrorResponse(e,103,`Failed to launch ${this.serverController.name} GDB Server: ${t.toString()}`)});let d=b.setTimeout(()=>{this.server.exit(),this.sendEvent(new c.TelemetryEvent("Error","Launching Server",`Failed to launch ${this.serverController.name} GDB Server: Timeout.`)),this.sendErrorResponse(e,103,`Failed to launch ${this.serverController.name} GDB Server: Timeout.`)},u.GDBServer.SERVER_TIMEOUT);this.serverController.serverLaunchStarted(),this.server.init().then(s=>{d&&(clearTimeout(d),d=null),this.serverController.serverLaunchCompleted();let r=["-q","--interpreter=mi2"];r=r.concat(this.args.debuggerArgs||[]),this.miDebugger=new i.MI2(o,r),this.initDebugger(),this.miDebugger.printCalls=!!this.args.showDevDebugOutput,this.miDebugger.debugOutput=!!this.args.showDevDebugOutput;const n=[`interpreter-exec console "source ${this.args.extensionPath}/support/gdbsupport.init"`];if(this.args.demangle&&(n.push('interpreter-exec console "set print demangle on"'),n.push('interpreter-exec console "set print asm-demangle on"')),n.push(...this.serverController.initCommands()),t){n.push(...this.args.preAttachCommands.map(L));const e=null!=this.args.overrideAttachCommands?this.args.overrideAttachCommands.map(L):this.serverController.attachCommands();n.push(...e),n.push(...this.args.postAttachCommands.map(L)),n.push(...this.serverController.swoCommands())}else{n.push(...this.args.preLaunchCommands.map(L));const e=null!=this.args.overrideLaunchCommands?this.args.overrideLaunchCommands.map(L):this.serverController.launchCommands();n.push(...e),n.push(...this.args.postLaunchCommands.map(L)),n.push(...this.serverController.swoCommands())}this.serverController.debuggerLaunchStarted(),this.miDebugger.once("debug-ready",()=>{this.debugReady=!0,this.attached=t});{const e=`Launching GDB: "${o}" `+r.map(e=>'"'+e.replace(/"/g,'\\"')+'"').join(" ")+"\n";this.handleMsg("log",e)}this.disableSendStoppedEvents=!(t||!this.args.runToMain),this.miDebugger.connect(this.args.cwd,this.args.executable,n).then(()=>{this.started=!0,this.serverController.debuggerLaunchCompleted(),this.sendResponse(e);const t=()=>{this.disableSendStoppedEvents=!1,b.setTimeout(()=>{this.stopped=!0,this.stoppedReason="start",this.stoppedThreadId=this.currentThreadId,this.sendEvent(new c.StoppedEvent("start",this.currentThreadId,!0)),this.sendEvent(new q("start",this.currentThreadId))},50)};this.args.runToMain?this.miDebugger.sendCommand("break-insert -t --function main").then(()=>{this.miDebugger.once("generic-stopped",t),this.configDone?this.miDebugger.sendCommand("exec-continue"):this.onConfigDone.once("done",()=>{this.miDebugger.sendCommand("exec-continue")})}):(t(),this.configDone?this.runPostStartSessionCommands(!1):this.onConfigDone.once("done",()=>{this.runPostStartSessionCommands(!1)}))},t=>{this.sendErrorResponse(e,103,`Failed to launch GDB: ${t.toString()}`),this.sendEvent(new c.TelemetryEvent("Error","Launching GDB",t.toString()))})},t=>{d&&(clearTimeout(d),d=null),this.sendEvent(new c.TelemetryEvent("Error","Launching Server",`Failed to launch ${this.serverController.name} GDB Server: ${t.toString()}`)),this.sendErrorResponse(e,103,`Failed to launch ${this.serverController.name} GDB Server: ${t.toString()}`)})},t=>{this.sendEvent(new c.TelemetryEvent("Error","Launching Server",`Failed to find open ports: ${t.toString()}`)),this.sendErrorResponse(e,103,`Failed to find open ports: ${t.toString()}`)})}calculatePortsNeeded(){const e=this.serverController.portsNeeded.length,t=Math.max(this.args.numberOfProcessors||1,1);let s=this.args.targetProcessor||0;(s<0||s>=t)&&(s=s<0?0:t-1,this.handleMsg("log",`launch.json: 'targetProcessor' must be >= 0 && < 'numberOfProcessors'. Setting it to ${s}`+"\n"),s=t-1);const r=e*t;return this.args.numberOfProcessors=t,this.args.targetProcessor=s,r}createPortsMap(e){const t=this.args.numberOfProcessors;this.ports={};let s=0;for(const r of this.serverController.portsNeeded)for(let n=0;n<t;n++){const t=c.createPortName(n,r);this.ports[t]=e[s++]}}runPostStartSessionCommands(e,t=10){let s=e?this.args.postRestartSessionCommands:this.args.postStartSessionCommands;if(s&&s.length>0){let e=this.miDebugger.getCurrentToken();s=s.map(L);const r=setInterval(()=>{const t=this.miDebugger.getCurrentToken();e===t?(clearInterval(r),this.miDebugger.postStart(s)):e=t},t)}}customRequest(e,t,s){if(this.serverController.customRequest(e,t,s))this.sendResponse(t);else switch(e){case"set-force-disassembly":t.body={success:!0},this.forceDisassembly=s.force,this.stopped&&(this.activeEditorPath=null,this.sendEvent(new n.ContinuedEvent(this.currentThreadId,!0)),this.sendEvent(new c.StoppedEvent(this.stoppedReason,this.currentThreadId,!0))),this.sendResponse(t);break;case"load-function-symbols":t.body={functionSymbols:this.symbolTable.getFunctionSymbols()},this.sendResponse(t);break;case"set-active-editor":s.path!==this.activeEditorPath&&(this.activeEditorPath=s.path),t.body={},this.sendResponse(t);break;case"get-arguments":t.body=this.args,this.sendResponse(t);break;case"read-memory":if(!1===this.stopped)return;this.readMemoryRequestCustom(t,s.address,s.length);break;case"write-memory":if(!1===this.stopped)return;this.writeMemoryRequest(t,s.address,s.data);break;case"read-registers":if(!1===this.stopped)return;this.readRegistersRequest(t);break;case"read-register-list":if(!1===this.stopped)return;this.readRegisterListRequest(t);break;case"disassemble":this.disassembleRequest(t,s);break;case"execute-command":let r=s.command;r=r.startsWith("-")?r.substring(1):`interpreter-exec console "${r}"`,this.miDebugger.sendCommand(r).then(e=>{t.body=e.resultRecords,this.sendResponse(t)},e=>{t.body=e,this.sendErrorResponse(t,110,"Unable to execute command")});break;default:t.body={error:"Invalid command."},this.sendResponse(t)}}disassembleRequest(e,t){return r(this,void 0,void 0,function*(){if(t.function)try{const s=yield this.getDisassemblyForFunction(t.function,t.file);e.body={instructions:s.instructions,name:s.name,file:s.file,address:s.address,length:s.length},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,1,`Unable to disassemble: ${t.toString()}`)}else if(t.startAddress)try{let s=this.symbolTable.getFunctionAtAddress(t.startAddress);if(s)s=yield this.getDisassemblyForFunction(s.name,s.file),e.body={instructions:s.instructions,name:s.name,file:s.file,address:s.address,length:s.length},this.sendResponse(e);else{const s=yield this.getDisassemblyForAddresses(t.startAddress,t.length||256);e.body={instructions:s},this.sendResponse(e)}}catch(t){this.sendErrorResponse(e,1,`Unable to disassemble: ${t.toString()}`)}else this.sendErrorResponse(e,1,"Unable to disassemble; invalid parameters.")})}getDisassemblyForFunction(e,t){return r(this,void 0,void 0,function*(){const s=this.symbolTable.getFunctionByName(e,t);if(!s)throw new Error(`Unable to find function with name ${e}.`);if(s.instructions)return s;const r=s.address,n=s.address+s.length,i=(yield this.miDebugger.sendCommand(`data-disassemble -s ${o.hexFormat(r,8)} -e ${o.hexFormat(n,8)} -- 2`)).result("asm_insns").map(e=>{return{address:l.MINode.valueOf(e,"address"),functionName:l.MINode.valueOf(e,"func-name"),offset:parseInt(l.MINode.valueOf(e,"offset")),instruction:l.MINode.valueOf(e,"inst"),opcodes:l.MINode.valueOf(e,"opcodes")}});return s.instructions=i,s})}getDisassemblyForAddresses(e,t){return r(this,void 0,void 0,function*(){const s=e+t;return(yield this.miDebugger.sendCommand(`data-disassemble -s ${o.hexFormat(e,8)} -e ${o.hexFormat(s,8)} -- 2`)).result("asm_insns").map(e=>{return{address:l.MINode.valueOf(e,"address"),functionName:l.MINode.valueOf(e,"func-name"),offset:parseInt(l.MINode.valueOf(e,"offset")),instruction:l.MINode.valueOf(e,"inst"),opcodes:l.MINode.valueOf(e,"opcodes")}})})}readMemoryRequestCustom(e,t,s){this.miDebugger.sendCommand(`data-read-memory-bytes "${t}" ${s}`).then(t=>{const s=t.resultRecords.results[0][1][0][0][1],r=t.resultRecords.results[0][1][0][2][1],n=t.resultRecords.results[0][1][0][3][1].match(/[0-9a-f]{2}/g).map(e=>parseInt(e,16));e.body={startAddress:s,endAddress:r,bytes:n},this.sendResponse(e)},r=>{e.body={error:r},this.sendErrorResponse(e,114,`Unable to read memory: ${r.toString()}`),this.sendEvent(new c.TelemetryEvent("Error","Reading Memory",`${t}-${s.toString(16)}`))})}writeMemoryRequest(e,t,s){const r=o.hexFormat(t,8);this.miDebugger.sendCommand(`data-write-memory-bytes ${r} ${s}`).then(t=>{this.sendResponse(e)},r=>{e.body={error:r},this.sendErrorResponse(e,114,`Unable to write memory: ${r.toString()}`),this.sendEvent(new c.TelemetryEvent("Error","Writing Memory",`${t.toString(16)}-${s.length.toString(16)}`))})}readRegistersRequest(e){const t=this.args.registerUseNaturalFormat?"N":"x";this.miDebugger.sendCommand(`data-list-register-values ${t}`).then(t=>{if("done"===t.resultRecords.resultClass){const s=t.resultRecords.results[0][1];e.body=s.map(e=>{const t={};return e.forEach(e=>{t[e[0]]=e[1]}),t})}else e.body={error:"Unable to parse response"};this.sendResponse(e)},t=>{e.body={error:t},this.sendErrorResponse(e,115,`Unable to read registers: ${t.toString()}`),this.sendEvent(new c.TelemetryEvent("Error","Reading Registers",""))})}readRegisterListRequest(e){this.miDebugger.sendCommand("data-list-register-names").then(t=>{if("done"===t.resultRecords.resultClass){let s;t.resultRecords.results.forEach(e=>{"register-names"===e[0]&&(s=e[1])}),e.body=s}else e.body={error:t.resultRecords.results};this.sendResponse(e)},t=>{e.body={error:t},this.sendErrorResponse(e,116,`Unable to read register list: ${t.toString()}`),this.sendEvent(new c.TelemetryEvent("Error","Reading Register List",""))})}disconnectRequest(e,t){const s=()=>{this.attached?(this.attached=!1,this.miDebugger.detach()):this.miDebugger.stop(),this.commandServer&&(this.commandServer.close(),this.commandServer=void 0),b.setTimeout(()=>{try{this.disableSendStoppedEvents=!1,this.server.exit()}catch(e){}finally{this.sendResponse(e)}},50)};this.disableSendStoppedEvents=!0,this.miDebugger&&(this.attached&&!this.stopped?(this.miDebugger.once("generic-stopped",s),this.miDebugger.sendCommand("exec-interrupt")):s())}restartRequest(e,t){const s=()=>r(this,void 0,void 0,function*(){this.disableSendStoppedEvents=!1;const t=[];t.push(...this.args.preRestartCommands.map(L));const s=null!=this.args.overrideRestartCommands?this.args.overrideRestartCommands.map(L):this.serverController.restartCommands();t.push(...s),t.push(...this.args.postRestartCommands.map(L)),t.push(...this.serverController.swoCommands()),this.miDebugger.restart(t).then(t=>{this.sendResponse(e),b.setTimeout(()=>{this.stopped=!0,this.stoppedReason="restart",this.sendEvent(new n.ContinuedEvent(this.currentThreadId,!0)),this.sendEvent(new c.StoppedEvent("restart",this.currentThreadId,!0)),this.sendEvent(new q("restart",this.currentThreadId)),this.runPostStartSessionCommands(!0,50)},50)},t=>{this.sendErrorResponse(e,6,`Could not restart: ${t}`)})});this.disableSendStoppedEvents=!0,this.stopped?s():(this.miDebugger.once("generic-stopped",s),this.miDebugger.sendCommand("exec-interrupt"))}wrapTimeStamp(e){if(this.args.showDevDebugOutput&&this.args.showDevDebugTimestamps){let t=(Date.now()-this.timeStart).toString();for(;t.length<10;)t="0"+t;return t+": "+e}return e}handleAdapterOutput(e){this.sendEvent(new c.AdapterOutputEvent(e,"out"))}serverControllerEvent(e){this.sendEvent(e)}handleMsg(e,t){"target"===e&&(e="stdout"),"log"===e&&(e="stderr"),this.sendEvent(new n.OutputEvent(this.wrapTimeStamp(t),e))}handleRunning(e){this.stopped=!1,this.sendEvent(new n.ContinuedEvent(this.currentThreadId,!0)),this.sendEvent(new j(this.currentThreadId,!0))}findPausedThread(e){if(e.outOfBandRecord&&e.outOfBandRecord[0]&&e.outOfBandRecord[0].output)for(const t of e.outOfBandRecord[0].output)if("thread-id"===t[0])return this.currentThreadId=parseInt(t[1]),this.stoppedThreadId=this.currentThreadId,void(B&&this.handleMsg("stdout",`**** Paused Thread: ${this.stoppedThreadId}\n`));B&&this.handleMsg("stdout",`**** Paused Thread: not found. Using ID ${this.stoppedThreadId}. Not good\n`)}handleBreakpoint(e){this.stopped=!0,this.stoppedReason="breakpoint",this.findPausedThread(e),this.disableSendStoppedEvents?this.stoppedEventPending=!0:(this.sendEvent(new c.StoppedEvent("breakpoint",this.currentThreadId,!0)),this.sendEvent(new q("breakpoint",this.currentThreadId)))}handleBreak(e){this.stopped=!0,this.stoppedReason="step",this.findPausedThread(e),this.disableSendStoppedEvents?this.stoppedEventPending=!0:(this.sendEvent(new c.StoppedEvent("step",this.currentThreadId,!0)),this.sendEvent(new q("step",this.currentThreadId)))}sendEvent(e){super.sendEvent(e),B&&(e instanceof c.StoppedEvent||e instanceof n.ContinuedEvent)&&this.handleMsg("log","**** Event: "+JSON.stringify(e)+"\n")}handlePause(e){this.stopped=!0,this.stoppedReason="user request",this.findPausedThread(e),this.disableSendStoppedEvents?this.stoppedEventPending=!0:(this.sendEvent(new c.StoppedEvent("user request",this.currentThreadId,!0)),this.sendEvent(new q("user request",this.currentThreadId)))}handleThreadCreated(e){this.activeThreadIds.has(e.threadId)?this.handleMsg("log",`Thread Error: GDB trying to create thread '${e.threadId}' that already exists`):(B&&this.handleMsg("log",`**** Thread created ${e.threadId}\n`),this.activeThreadIds.add(e.threadId),this.sendEvent(new n.ThreadEvent("started",e.threadId)))}handleThreadExited(e){B&&this.handleMsg("log",`**** Thread exited ${e.threadId}\n`),this.activeThreadIds.has(e.threadId)?this.activeThreadIds.delete(e.threadId):this.handleMsg("log",`Thread Error: GDB trying to delete thread '${e.threadId}' that does not exist.\n`),this.currentThreadId===e.threadId&&(this.currentThreadId=0),this.stoppedThreadId===e.threadId&&(this.stoppedThreadId=0),this.sendEvent(new n.ThreadEvent("exited",e.threadId))}handleThreadSelected(e){B&&this.handleMsg("log",`**** Thread selected ${e.threadId}\n`),this.activeThreadIds.has(e.threadId)?this.currentThreadId=e.threadId:this.handleMsg("log",`Thread Error: GDB trying to select thread '${e.threadId}' that does not exist. No harm done\n`)}handleThreadGroupExited(e){B&&this.handleMsg("log",`**** Thread group exited ${e.threadGroupId}\n`),this.currentThreadId=0;for(const e of this.activeThreadIds.values())this.sendEvent(new n.ThreadEvent("exited",e));this.activeThreadIds.clear()}stopEvent(e){this.started||(this.crashed=!0),this.quit||(this.stopped=!0,this.stoppedReason="exception",this.findPausedThread(e),this.sendEvent(new c.StoppedEvent("exception",this.currentThreadId,!0)),this.sendEvent(new q("exception",this.currentThreadId)))}quitEvent(){B&&this.handleMsg("log","**** quit event\n"),this.quit=!0,this.sendEvent(new n.TerminatedEvent)}launchError(e){this.handleMsg("stderr","Could not start debugger process, does the program exist in filesystem?\n"),this.handleMsg("stderr",e.toString()+"\n"),this.quitEvent()}static decodeReference(e){return[(65280&e)>>>8,255&e]}static encodeReference(e,t){return 65535&(e<<8|255&t)}setVariableRequest(e,t){return r(this,void 0,void 0,function*(){try{let s=t.name,r=-1,n=-1;const i=t.variablesReference,o=this.getFloatingVariable(i,s);if(o)s=o.name;else if(i>=_){const e=this.variableHandles.get(t.variablesReference),r=e.children[s];s=r||`${e.name}.${s}`}else if(i>=$&&i<D){const e=this.createStackVarName(s,i);this.variableHandlesReverse.hasOwnProperty(e)&&(s=e),[r,n]=U.decodeReference(i)}const a=yield this.miDebugger.varAssign(s,t.value,r,n);e.body={value:a.result("value")},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,11,`Could not set variable: ${t}`)}})}setFunctionBreakPointsRequest(e,t){const s=s=>r(this,void 0,void 0,function*(){this.disableSendStoppedEvents=!1;const r=[];t.breakpoints.forEach(e=>{r.push(this.miDebugger.addBreakPoint({raw:e.name,condition:e.condition,countCondition:e.hitCondition}))});try{const t=yield Promise.all(r),s=[];t.forEach(e=>{e[0]&&s.push({line:e[1].line})}),e.body={breakpoints:s},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,10,t.toString())}s&&(yield this.miDebugger.sendCommand("exec-continue"))}),n=()=>r(this,void 0,void 0,function*(){this.stopped?yield s(!1):(this.disableSendStoppedEvents=!0,this.miDebugger.once("generic-stopped",()=>{s(!0)}),this.miDebugger.sendCommand("exec-interrupt"))});this.debugReady?n():this.miDebugger.once("debug-ready",n)}setBreakPointsRequest(e,t){const s=s=>r(this,void 0,void 0,function*(){this.debugReady=!0;const r=(this.breakpointMap.get(t.source.path)||[]).map(e=>e.number);try{this.disableSendStoppedEvents=!1,yield this.miDebugger.removeBreakpoints(r),this.breakpointMap.set(t.source.path,[]);const s=[],n=decodeURIComponent(t.source.path);if(n.startsWith("disassembly:/")){let e=13;n.startsWith("disassembly:///")&&(e=15);const r=n.substring(e,n.length-6).split(":::");let i,o;2===r.length?(i=r[1],o=r[0]):i=r[0];const a=yield this.getDisassemblyForFunction(i,o);a&&t.breakpoints.forEach(e=>{if(e.line<=a.instructions.length){const r=a.instructions[e.line-1];s.push(this.miDebugger.addBreakPoint({file:t.source.path,line:e.line,condition:e.condition,countCondition:e.hitCondition,raw:r.address}))}})}else t.breakpoints.forEach(e=>{s.push(this.miDebugger.addBreakPoint({file:t.source.path,line:e.line,condition:e.condition,countCondition:e.hitCondition}))});const i=(yield Promise.all(s)).filter(e=>null!==e);e.body={breakpoints:i.map(e=>({line:e.line,id:e.number,verified:!0}))},this.breakpointMap.set(t.source.path,i),this.sendResponse(e)}catch(t){this.sendErrorResponse(e,9,t.toString())}s&&(yield this.miDebugger.sendCommand("exec-continue"))}),n=()=>r(this,void 0,void 0,function*(){this.stopped?yield s(!1):(this.disableSendStoppedEvents=!0,this.miDebugger.once("generic-stopped",()=>{s(!0)}),this.miDebugger.sendCommand("exec-interrupt"))});this.debugReady?n():this.miDebugger.once("debug-ready",n)}threadsRequest(e){return r(this,void 0,void 0,function*(){if(!this.stopped||this.disableSendStoppedEvents)return e.body={threads:[]},this.sendResponse(e),Promise.resolve();try{const t=yield this.miDebugger.sendCommand("thread-list-ids"),s=t.result("thread-ids").map(e=>parseInt(e[1])),r=t.result("current-thread-id");if(!s||0===s.length)return e.body={threads:[]},this.sendResponse(e),Promise.resolve();for(const e of s)this.activeThreadIds.has(e)||this.handleThreadCreated({threadId:e,threadGroupId:"i1"});r?(this.currentThreadId=parseInt(r),B&&this.handleMsg("log",`**** thread-list-ids: current thread = ${this.currentThreadId}\n`)):(this.currentThreadId=s.findIndex(e=>e===this.stoppedThreadId)>=0?this.stoppedThreadId:s[0],B&&this.handleMsg("log",`**** thread-list-ids: no current thread, setting to ${this.currentThreadId}\n`),s.length>1&&(yield this.miDebugger.sendCommand(`thread-select ${this.currentThreadId}`))),(this.stoppedEventPending||this.currentThreadId!==this.stoppedThreadId)&&(this.stoppedEventPending=!1,this.stoppedThreadId=this.currentThreadId,this.sendEvent(new c.StoppedEvent(this.stoppedReason,this.currentThreadId,!0)),this.sendEvent(new q(this.stoppedReason,this.currentThreadId)));const i=(yield Promise.all(s.map(e=>this.miDebugger.sendCommand(`thread-info ${e}`)))).map(e=>{let t=e.result("threads");if(1===t.length){t=t[0];const e=parseInt(l.MINode.valueOf(t,"id")),s=l.MINode.valueOf(t,"target-id"),r=l.MINode.valueOf(t,"details");let i=l.MINode.valueOf(t,"name");return i&&r&&i!==r?i+=` (${r})`:i=i||r||s,new n.Thread(e,i)}return null}).filter(e=>null!==e);e.body={threads:i},this.sendResponse(e)}catch(t){this.stopped&&this.sendErrorResponse(e,1,`Unable to get thread information: ${t}`)}})}stackTraceRequest(e,t){return r(this,void 0,void 0,function*(){try{const s=yield this.miDebugger.getStackDepth(t.threadId),r=Math.min(s,t.startFrame+t.levels)-1,i=yield this.miDebugger.getStack(t.threadId,t.startFrame,r),o=[];for(const e of i){const s=U.encodeReference(t.threadId,e.level),r=e.file;let i=this.forceDisassembly||!r;if(i||(i=!(yield this.checkFileExists(r))),!i&&this.activeEditorPath&&this.activeEditorPath.startsWith("disassembly:///")){const t=this.symbolTable.getFunctionByName(e.function,e.fileName);let s;t&&(s=t.file&&t.scope!==P.SymbolScope.Global?`disassembly:///${t.file}:::${t.name}.cdasm`:`disassembly:///${t.name}.cdasm`)===this.activeEditorPath&&(i=!0)}try{if(i){const t=yield this.getDisassemblyForFunction(e.function,e.fileName);let r=-1;if(t.instructions.forEach((t,s)=>{t.address===e.address&&(r=s+1)}),-1!==r){let i;const a="disassembly:///"+(i=t.file&&t.scope!==P.SymbolScope.Global?`${t.file}:::${t.name}.cdasm`:`${t.name}.cdasm`);o.push(new n.StackFrame(s,`${e.function}@${e.address}`,new n.Source(i,a),r,0))}else o.push(new n.StackFrame(s,e.function+"@"+e.address,null,e.line,0))}else o.push(new n.StackFrame(s,e.function+"@"+e.address,new n.Source(e.fileName,r),e.line,0))}catch(t){o.push(new n.StackFrame(s,e.function+"@"+e.address,null,e.line,0))}}e.body={stackFrames:o,totalFrames:s},this.sendResponse(e)}catch(t){this.stopped&&this.sendErrorResponse(e,12,`Failed to get Stack Trace: ${t.toString()}`)}})}configurationDoneRequest(e,t){this.sendResponse(e),this.onConfigDone.emit("done"),this.configDone=!0}scopesRequest(e,t){const s=new Array;s.push(new n.Scope("Local",parseInt(t.frameId),!1)),s.push(new n.Scope("Global",A,!1));const r=N+parseInt(t.frameId);s.push(new n.Scope("Static",r,!1)),this.floatingVariableMap[r]={},e.body={scopes:s},this.sendResponse(e)}globalVariablesRequest(e,t){return r(this,void 0,void 0,function*(){const s=this.symbolTable.getGlobalVariables(),r=[];try{for(const e of s){const s=`global_var_${e.name}`;let n;try{(yield this.miDebugger.varUpdate(s,-1,-1)).result("changelist").forEach(e=>{const t=l.MINode.valueOf(e,"name"),s=this.variableHandlesReverse[t];this.variableHandles.get(s).applyChanges(e)});const t=this.variableHandlesReverse[s];n=this.variableHandles.get(t)}catch(t){try{if(!(t instanceof a.MIError&&"Variable object not found"===t.message))throw t;{n=yield this.miDebugger.varCreate(e.name,s);const t=this.findOrCreateVariable(n);n.exp=e.name,n.id=t}}catch(t){this.args.showDevDebugOutput&&(this.handleMsg("stderr",`Could not create global variable ${e.name}\n`),this.handleMsg("stderr",`Error: ${t}\n`)),n=null}}n&&(this.putFloatingVariable(t.variablesReference,e.name,n),r.push(n.toProtocolVariable()))}e.body={variables:r},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,1,`Could not get global variable information: ${t}`)}})}createStaticVarName(e,t){return`static_var_${t}_${e}`}putFloatingVariable(e,t,s){const r=this.floatingVariableMap[e]||{};r[t]=s,this.floatingVariableMap[e]=r}getFloatingVariable(e,t){const s=this.floatingVariableMap[e];return s?s[t]:null}staticVariablesRequest(e,t,s,n){return r(this,void 0,void 0,function*(){const r=[];try{const i=(yield this.miDebugger.getFrame(e,t)).fileName,o=this.symbolTable.getStaticVariables(i),c=g.createHash("sha256");c.update(i);const u=c.digest("hex");for(const e of o){const t=this.createStaticVarName(u,e.name);let s;try{(yield this.miDebugger.varUpdate(t,-1,-1)).result("changelist").forEach(e=>{const t=l.MINode.valueOf(e,"name"),s=this.variableHandlesReverse[t];this.variableHandles.get(s).applyChanges(e)});const r=this.variableHandlesReverse[t];s=this.variableHandles.get(r)}catch(r){try{if(!(r instanceof a.MIError&&"Variable object not found"===r.message))throw r;{s=yield this.miDebugger.varCreate(e.name,t);const r=this.findOrCreateVariable(s);s.exp=e.name,s.id=r}}catch(t){this.args.showDevDebugOutput&&(this.handleMsg("stderr",`Could not create static variable ${i}:${e.name}\n`),this.handleMsg("stderr",`Error: ${t}\n`)),s=null}}s&&(this.putFloatingVariable(n.variablesReference,e.name,s),r.push(s.toProtocolVariable()))}s.body={variables:r},this.sendResponse(s)}catch(e){this.sendErrorResponse(s,1,`Could not get static variable information: ${e}`)}})}createVariable(e,t){return t?this.variableHandles.create(new F(e,t)):this.variableHandles.create(e)}findOrCreateVariable(e){let t;return this.variableHandlesReverse.hasOwnProperty(e.name)?t=this.variableHandlesReverse[e.name]:(t=this.createVariable(e),this.variableHandlesReverse[e.name]=t),e.isCompound()?t:0}createStackVarName(e,t){return`var_${e}_${t}`}stackVariablesRequest(e,t){return r(this,void 0,void 0,function*(){const[s,r]=U.decodeReference(t.variablesReference),n=[];let i;try{i=yield this.miDebugger.getStackVariables(s,r);for(const e of i)try{const i=this.createStackVarName(e.name,t.variablesReference);let o;try{(yield this.miDebugger.varUpdate(i,s,r)).result("changelist").forEach(e=>{const t=l.MINode.valueOf(e,"name"),s=this.variableHandlesReverse[t];this.variableHandles.get(s).applyChanges(e)});const t=this.variableHandlesReverse[i];o=this.variableHandles.get(t)}catch(t){if(!(t instanceof a.MIError&&"Variable object not found"===t.message))throw t;{o=yield this.miDebugger.varCreate(e.name,i,"*");const t=this.findOrCreateVariable(o);o.exp=e.name,o.id=t}}n.push(o.toProtocolVariable())}catch(t){n.push({name:e.name,value:`<${t}>`,variablesReference:0})}e.body={variables:n},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,1,`Could not get stack variables: ${t}`)}})}variableMembersRequest(e,t,s){return r(this,void 0,void 0,function*(){let s;try{s=yield this.miDebugger.evalExpression(JSON.stringify(e),-1,-1);try{let r=d.expandValue(this.createVariable.bind(this),s.result("value"),e,s);r?("string"==typeof r[0]&&(r=[{name:"<value>",value:H(r),variablesReference:0}]),t.body={variables:r},this.sendResponse(t)):this.sendErrorResponse(t,2,"Could not expand variable")}catch(e){this.sendErrorResponse(t,2,`Could not expand variable: ${e}`)}}catch(e){this.sendErrorResponse(t,1,`Could not expand variable: ${e}`)}})}variablesRequest(e,t){return r(this,void 0,void 0,function*(){let s;if(t.variablesReference===A)return this.globalVariablesRequest(e,t);if(t.variablesReference>=N&&t.variablesReference<=k){const[s,r]=U.decodeReference(t.variablesReference);return this.staticVariablesRequest(s,r,e,t)}if(t.variablesReference>=$&&t.variablesReference<D)return this.stackVariablesRequest(e,t);if("string"==typeof(s=this.variableHandles.get(t.variablesReference)))return this.variableMembersRequest(s,e,t);if("object"==typeof s)if(s instanceof a.VariableObject){const t=s;let r;const n={};try{const i=(r=yield this.miDebugger.varListChildren(s.name,this.args.flattenAnonymous)).map(e=>{const s=this.findOrCreateVariable(e);if(e.id=s,/^\d+$/.test(e.exp))e.fullExp=`${t.fullExp||t.exp}[${e.exp}]`;else{let s="."+e.exp;if(e.exp.startsWith("<anonymous")){const t=n[e.exp];t&&(n[e.exp]=t+1,e.exp+="#"+t.toString(10)),n[e.exp]=1,s=""}else t.children[e.exp]=e.name;e.fullExp=`${t.fullExp||t.exp}${s}`}return e.toProtocolVariable()});e.body={variables:i},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,1,`Could not expand variable: ${t}`)}}else if(s instanceof F){const t=s;if(t.options.arg){const s=[];let n=!0,i=0;const o=()=>{e.body={variables:s},this.sendResponse(e)},a=()=>r(this,void 0,void 0,function*(){const r=yield this.miDebugger.evalExpression(JSON.stringify(`${t.name}+${i})`),-1,-1);try{const c=d.expandValue(this.createVariable.bind(this),r.result("value"),t.name,r);if(c)if("string"==typeof c){if("<nullptr>"===c){if(!n)return o();n=!1}else if('"'!==c[0])return s.push({name:"[err]",value:c,variablesReference:0}),o();s.push({name:`[${i++}]`,value:c,variablesReference:0}),a()}else s.push({name:"[err]",value:c,variablesReference:0}),o();else this.sendErrorResponse(e,15,"Could not expand variable")}catch(t){this.sendErrorResponse(e,14,`Could not expand variable: ${t}`)}});a()}else this.sendErrorResponse(e,13,`Unimplemented variable request options: ${JSON.stringify(t.options)}`)}else e.body={variables:s},this.sendResponse(e);else e.body={variables:[]},this.sendResponse(e)})}pauseRequest(e,t){this.miDebugger.interrupt().then(t=>{this.sendResponse(e)},t=>{this.sendErrorResponse(e,3,`Could not pause: ${t}`)})}continueRequest(e,t){this.miDebugger.continue(t.threadId).then(t=>{e.body={allThreadsContinued:!0},this.sendResponse(e)},t=>{this.sendErrorResponse(e,2,`Could not continue: ${t}`)})}stepInRequest(e,t){return r(this,void 0,void 0,function*(){try{let s=this.forceDisassembly;if(!s){const e=yield this.miDebugger.getFrame(t.threadId,0);if(s=!(yield this.checkFileExists(e.file)),this.activeEditorPath&&this.activeEditorPath.startsWith("disassembly:///")){const t=this.symbolTable.getFunctionByName(e.function,e.fileName);if(t){let e;(e=t.file&&t.scope!==P.SymbolScope.Global?`disassembly:///${t.file}:::${t.name}.cdasm`:`disassembly:///${t.name}.cdasm`)===this.activeEditorPath&&(s=!0)}}}yield this.miDebugger.step(t.threadId,s);this.sendResponse(e)}catch(t){this.sendErrorResponse(e,6,`Could not step over: ${t}`)}})}stepOutRequest(e,t){this.miDebugger.stepOut(t.threadId).then(t=>{this.sendResponse(e)},t=>{this.sendErrorResponse(e,5,`Could not step out: ${t}`)})}nextRequest(e,t){return r(this,void 0,void 0,function*(){try{let s=this.forceDisassembly;if(!s){const e=yield this.miDebugger.getFrame(t.threadId,0);if(s=!(yield this.checkFileExists(e.file)),this.activeEditorPath&&this.activeEditorPath.startsWith("disassembly:///")){const t=this.symbolTable.getFunctionByName(e.function,e.fileName);if(t){let e;(e=t.file&&t.scope!==P.SymbolScope.Global?`disassembly:///${t.file}:::${t.name}.cdasm`:`disassembly:///${t.name}.cdasm`)===this.activeEditorPath&&(s=!0)}}}yield this.miDebugger.next(t.threadId,s);this.sendResponse(e)}catch(t){this.sendErrorResponse(e,6,`Could not step over: ${t}`)}})}checkFileExists(e){return e?this.fileExistsCache.has(e)?Promise.resolve(this.fileExistsCache.get(e)):new Promise((t,s)=>{f.exists(e,s=>{this.fileExistsCache.set(e,s),t(s)})}):Promise.resolve(!1)}evaluateRequest(e,t){return r(this,void 0,void 0,function*(){const s=(e,t)=>t?this.variableHandles.create(new F(e,t)):this.variableHandles.create(e),r=e=>{let t;return this.variableHandlesReverse.hasOwnProperty(e.name)?t=this.variableHandlesReverse[e.name]:(t=s(e),this.variableHandlesReverse[e.name]=t),e.isCompound()?t:0};let n=this.currentThreadId,i=0;if(t.frameId?([n,i]=U.decodeReference(t.frameId),B&&this.handleMsg("log",`**** evaluateRequest: ${t.context} '${t.expression}' in thread#${n} frame#${i}\n`)):this.handleMsg("log",`Thread Warning: ${t.context}: eval. expression '${t.expression}' with no thread context. Using default\n`),"watch"===t.context)try{const s=t.expression,o=g.createHash("sha256");o.update(s);const c=`watch_${o.digest("hex")}`;let u;try{(yield this.miDebugger.varUpdate(c,n,i)).result("changelist").forEach(e=>{const t=l.MINode.valueOf(e,"name"),s=this.variableHandlesReverse[t];this.variableHandles.get(s).applyChanges(e)});const t=this.variableHandlesReverse[c];u=this.variableHandles.get(t),e.body={result:u.value,variablesReference:u.id}}catch(t){if(!(t instanceof a.MIError&&"Variable object not found"===t.message))throw t;{const t=r(u=yield this.miDebugger.varCreate(s,c,"@"));u.exp=s,u.id=t,e.body={result:u.value,variablesReference:u.id}}}this.sendResponse(e)}catch(t){e.body={result:`<${t.toString()}>`,variablesReference:0},this.sendResponse(e),this.args.showDevDebugOutput&&this.handleMsg("stderr","watch: "+t.toString())}else if("hover"===t.context)try{const s=yield this.miDebugger.evalExpression(t.expression,n,i);e.body={variablesReference:0,result:s.result("value")},this.sendResponse(e)}catch(t){e.body={variablesReference:0,result:""},this.sendResponse(e),this.args.showDevDebugOutput&&this.handleMsg("stderr","hover: "+t.toString())}else this.miDebugger.sendCommand(`thread-select ${n}`),this.miDebugger.sendCommand(`stack-select-frame ${i}`),this.miDebugger.sendUserInput(t.expression).then(t=>{e.body=void 0===t?{result:"",variablesReference:0}:{result:JSON.stringify(t),variablesReference:0},this.sendResponse(e)},t=>{this.sendErrorResponse(e,8,t.toString())})})}}function H(e){return"object"==typeof e?void 0!==e.length?e.join(", "):JSON.stringify(e):e}t.GDBDebugSession=U,n.DebugSession.run(U)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),n=s(9);class i extends r.EventEmitter{constructor(){super(),this._pendingRequests=new Map}start(e,t){this._sequence=1,this._writableStream=t,this._rawData=new Buffer(0),e.on("data",e=>this._handleData(e)),e.on("close",()=>{this._emitEvent(new n.Event("close"))}),e.on("error",e=>{this._emitEvent(new n.Event("error","inStream error: "+(e&&e.message)))}),t.on("error",e=>{this._emitEvent(new n.Event("error","outStream error: "+(e&&e.message)))}),e.resume()}stop(){this._writableStream&&this._writableStream.end()}sendEvent(e){this._send("event",e)}sendResponse(e){e.seq>0?console.error(`attempt to send more than one response for command ${e.command}`):this._send("response",e)}sendRequest(e,t,s,r){const i={command:e};if(t&&Object.keys(t).length>0&&(i.arguments=t),this._writableStream){if(this._send("request",i),r){this._pendingRequests.set(i.seq,r);const e=setTimeout(()=>{clearTimeout(e);const t=this._pendingRequests.get(i.seq);t&&(this._pendingRequests.delete(i.seq),t(new n.Response(i,"timeout")))},s)}}else this._emitEvent(new n.Event("error","sendRequest: No writableStream"))}dispatchRequest(e){}_emitEvent(e){this.emit(e.event,e)}_send(e,t){if(t.type=e,t.seq=this._sequence++,this._writableStream){const e=JSON.stringify(t);this._writableStream.write(`Content-Length: ${Buffer.byteLength(e,"utf8")}\r\n\r\n${e}`,"utf8")}}_handleData(e){for(this._rawData=Buffer.concat([this._rawData,e]);;){if(this._contentLength>=0){if(this._rawData.length>=this._contentLength){const e=this._rawData.toString("utf8",0,this._contentLength);if(this._rawData=this._rawData.slice(this._contentLength),this._contentLength=-1,e.length>0)try{let t=JSON.parse(e);if("request"===t.type)this.dispatchRequest(t);else if("response"===t.type){const e=t,s=this._pendingRequests.get(e.request_seq);s&&(this._pendingRequests.delete(e.request_seq),s(e))}}catch(e){this._emitEvent(new n.Event("error","Error handling data: "+(e&&e.message)))}continue}}else{const e=this._rawData.indexOf(i.TWO_CRLF);if(-1!==e){const t=this._rawData.toString("utf8",0,e).split("\r\n");for(let e=0;e<t.length;e++){const s=t[e].split(/: +/);"Content-Length"==s[0]&&(this._contentLength=+s[1])}this._rawData=this._rawData.slice(e+i.TWO_CRLF.length);continue}}break}}}i.TWO_CRLF="\r\n\r\n",t.ProtocolServer=i},function(e,t){e.exports=require("url")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(13),n=r.logger,i=s(8);t.LoggingDebugSession=class extends i.DebugSession{constructor(e,t,s){super(t,s),this.obsolete_logFilePath=e,this.on("error",e=>{n.error(e.body)})}start(e,t){super.start(e,t),n.init(e=>this.sendEvent(e),this.obsolete_logFilePath,this._isServer)}sendEvent(e){e instanceof r.LogOutputEvent||n.verbose(`To client: ${JSON.stringify(e)}`),super.sendEvent(e)}sendRequest(e,t,s,r){n.verbose(`To client: ${JSON.stringify(e)}(${JSON.stringify(t)}), timeout: ${s}`),super.sendRequest(e,t,s,r)}sendResponse(e){n.verbose(`To client: ${JSON.stringify(e)}`),super.sendResponse(e)}dispatchRequest(e){n.verbose(`From client: ${e.command}(${JSON.stringify(e.arguments)})`),super.dispatchRequest(e)}}},function(e,t,s){var r=s(1),n=s(3),i=parseInt("0777",8);function o(e,t,s,a){"function"==typeof t?(s=t,t={}):t&&"object"==typeof t||(t={mode:t});var c=t.mode,u=t.fs||n;void 0===c&&(c=i&~process.umask()),a||(a=null);var l=s||function(){};e=r.resolve(e),u.mkdir(e,c,function(s){if(!s)return l(null,a=a||e);switch(s.code){case"ENOENT":o(r.dirname(e),t,function(s,r){s?l(s,r):o(e,t,l,r)});break;default:u.stat(e,function(e,t){e||!t.isDirectory()?l(s,a):l(null,a)})}})}e.exports=o.mkdirp=o.mkdirP=o,o.sync=function e(t,s,o){s&&"object"==typeof s||(s={mode:s});var a=s.mode,c=s.fs||n;void 0===a&&(a=i&~process.umask()),o||(o=null),t=r.resolve(t);try{c.mkdirSync(t,a),o=o||t}catch(n){switch(n.code){case"ENOENT":o=e(r.dirname(t),s,o),e(t,s,o);break;default:var u;try{u=c.statSync(t)}catch(e){throw n}if(!u.isDirectory())throw n}}return o}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Handles=class{constructor(e){this.START_HANDLE=1e3,this._handleMap=new Map,this._nextHandle="number"==typeof e?e:this.START_HANDLE}reset(){this._nextHandle=this.START_HANDLE,this._handleMap=new Map}create(e){var t=this._nextHandle++;return this._handleMap.set(t,e),t}get(e,t){return this._handleMap.get(e)||t}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):new s(function(t){t(e.value)}).then(o,a)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const n=s(14),i=s(5),o=s(0),a=s(6),c=s(1),u=s(1);c.posix;function l(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}t.escape=l;const d=/^(?:\d*|undefined)[\*\+\=]|[\~\@\&\^]/,h=/(?:\d*|undefined)\(gdb\)/,p=/\d+/;function f(e){return!d.exec(e)}const m=!1;class g extends o.EventEmitter{constructor(e,t){super(),this.application=e,this.args=t,this.currentToken=1,this.handlers={}}connect(e,t,s){return u.isAbsolute(t)||(t=u.join(e,t)),new Promise((r,n)=>{const o=[...this.args,t];this.process=i.spawn(this.application,o,{cwd:e,env:this.procEnv}),this.process.stdout.on("data",this.stdout.bind(this)),this.process.stderr.on("data",this.stderr.bind(this)),this.process.on("exit",(()=>{this.emit("quit")}).bind(this)),this.process.on("error",(e=>{this.emit("launcherror",e)}).bind(this));const a=this.sendCommand("gdb-set target-async on",!0),c=s.map(e=>this.sendCommand(e));c.push(a),Promise.all(c).then(()=>{this.emit("debug-ready"),r()},n)})}stdout(e){m&&this.log("stderr","stdout: "+e),this.buffer+="string"==typeof e?e:e.toString("utf8");const t=this.buffer.lastIndexOf("\n");-1!==t&&(this.onOutput(this.buffer.substr(0,t)),this.buffer=this.buffer.substr(t+1)),this.buffer.length&&this.onOutputPartial(this.buffer)&&(this.buffer="")}stderr(e){this.errbuf+="string"==typeof e?e:e.toString("utf8");const t=this.errbuf.lastIndexOf("\n");-1!==t&&(this.onOutputStderr(this.errbuf.substr(0,t)),this.errbuf=this.errbuf.substr(t+1)),this.errbuf.length&&(this.logNoNewLine("stderr",this.errbuf),this.errbuf="")}onOutputStderr(e){(e=e.split("\n")).forEach(e=>{this.log("stderr",e)})}onOutputPartial(e){return!!f(e)&&(this.logNoNewLine("stdout",e),!0)}onOutput(e){(e=e.split("\n")).forEach(e=>{if(f(e))h.exec(e)||this.log("stdout",e);else{const t=a.parseMI(e);this.debugOutput&&this.log("log","GDB -> App: "+JSON.stringify(t));let s=!1;void 0!==t.token&&this.handlers[t.token]&&(this.handlers[t.token](t),delete this.handlers[t.token],s=!0),!s&&t.resultRecords&&"error"===t.resultRecords.resultClass&&this.log("stderr",t.result("msg")||e),t.outOfBandRecord&&(t.outOfBandRecord.forEach(e=>{if(e.isStream)this.log(e.type,e.content);else if("exec"===e.type)if(this.emit("exec-async-output",t),"running"===e.asyncClass)this.emit("running",t);else if("stopped"===e.asyncClass){const e=t.record("reason");m&&this.log("stderr","stop: "+e),"breakpoint-hit"===e?this.emit("breakpoint",t):"end-stepping-range"===e?this.emit("step-end",t):"function-finished"===e?this.emit("step-out-end",t):"signal-received"===e?this.emit("signal-stop",t):"exited-normally"===e?this.emit("exited-normally",t):"exited"===e?(this.log("stderr","Program exited with code "+t.record("exit-code")),this.emit("exited-normally",t)):(this.log("console","Not implemented stop reason (assuming exception): "+e),this.emit("stopped",t)),this.emit("generic-stopped",t)}else this.log("log",JSON.stringify(t));else if("notify"===e.type){let t,s;for(const r of e.output)"id"===r[0]?t=r[1]:"group-id"===r[0]&&(s=r[1]);"thread-created"===e.asyncClass?this.emit("thread-created",{threadId:parseInt(t),threadGroupId:s}):"thread-exited"===e.asyncClass?this.emit("thread-exited",{threadId:parseInt(t),threadGroupId:s}):"thread-selected"===e.asyncClass?this.emit("thread-selected",{threadId:parseInt(t)}):"thread-group-exited"===e.asyncClass&&this.emit("thread-group-exited",{threadGroupId:t})}}),s=!0),void 0===t.token&&void 0===t.resultRecords&&0===t.outOfBandRecord.length&&(s=!0),s||this.log("log","Unhandled: "+JSON.stringify(t))}})}tryKill(){const e=this.process;try{process.kill(-e.pid)}catch(t){this.log("log",`kill failed for ${-e.pid}`+t)}}stop(){return r(this,void 0,void 0,function*(){m&&this.log("stderr","stop");this.process;const e=setTimeout(()=>{this.tryKill()},1e3);this.process.on("exit",t=>{clearTimeout(e)}),yield this.sendCommand("target-disconnect"),this.sendRaw("-gdb-exit")})}detach(){return r(this,void 0,void 0,function*(){m&&this.log("stderr","detach"),yield this.sendCommand("target-detach"),this.stop()})}interrupt(e=""){return m&&this.log("stderr","interrupt "+e),new Promise((t,s)=>{this.sendCommand(`exec-interrupt ${e}`).then(e=>{t("done"===e.resultRecords.resultClass)},s)})}continue(e){return m&&this.log("stderr","continue"),new Promise((t,s)=>{this.sendCommand(`exec-continue --thread ${e}`).then(e=>{t("running"===e.resultRecords.resultClass)},s)})}next(e,t){return m&&this.log("stderr","next"),new Promise((s,r)=>{const n=t?"exec-next-instruction":"exec-next";this.sendCommand(`${n} --thread ${e}`).then(e=>{s("running"===e.resultRecords.resultClass)},r)})}step(e,t){return m&&this.log("stderr","step"),new Promise((s,r)=>{const n=t?"exec-step-instruction":"exec-step";this.sendCommand(`${n} --thread ${e}`).then(e=>{s("running"===e.resultRecords.resultClass)},r)})}stepOut(e){return m&&this.log("stderr","stepOut"),new Promise((t,s)=>{this.sendCommand(`exec-finish --thread ${e}`).then(e=>{t("running"===e.resultRecords.resultClass)},s)})}restart(e){return m&&this.log("stderr","restart"),this._sendCommandSequence(e)}postStart(e){return m&&this.log("stderr","post-start"),this._sendCommandSequence(e)}_sendCommandSequence(e){return new Promise((t,s)=>{const r=(e=>{if(0===e.length)t(!0);else{const t=e[0];this.sendCommand(t).then(t=>{r(e.slice(1))},s)}}).bind(this);r(e)})}changeVariable(e,t){return m&&this.log("stderr","changeVariable"),this.sendCommand("gdb-set var "+e+"="+t)}setBreakPointCondition(e,t){return m&&this.log("stderr","setBreakPointCondition"),this.sendCommand("break-condition "+e+" "+t)}addBreakPoint(e){return m&&this.log("stderr","addBreakPoint"),new Promise((t,s)=>{let r="";if(e.countCondition)if(">"===e.countCondition[0])r+="-i "+p.exec(e.countCondition.substr(1))[0]+" ";else{const t=p.exec(e.countCondition)[0];t.length!==e.countCondition.length?(this.log("stderr","Unsupported break count expression: '"+e.countCondition+"'. Only supports 'X' for breaking once after X times or '>X' for ignoring the first X breaks"),r+="-t "):0!==parseInt(t)&&(r+="-t -i "+parseInt(t)+" ")}e.raw?r+="*"+l(e.raw):r+='"'+l(e.file)+":"+e.line+'"',this.sendCommand(`break-insert ${r}`).then(r=>{if("done"===r.resultRecords.resultClass){const n=parseInt(r.result("bkpt.number"));e.number=n,e.condition?this.setBreakPointCondition(n,e.condition).then(s=>{"done"===s.resultRecords.resultClass?t(e):t(null)},s):t(e)}else t(null)},s)})}removeBreakpoints(e){return m&&this.log("stderr","removeBreakPoint"),new Promise((t,s)=>{if(0===e.length)t(!0);else{const r="break-delete "+e.join(" ");this.sendCommand(r).then(e=>{t("done"===e.resultRecords.resultClass)},s)}})}getFrame(e,t){return new Promise((s,r)=>{const n=`stack-info-frame --thread ${e} --frame ${t}`;this.sendCommand(n).then(e=>{const t=e.result("frame"),r=a.MINode.valueOf(t,"level"),n=a.MINode.valueOf(t,"addr"),i=a.MINode.valueOf(t,"func"),o=a.MINode.valueOf(t,"file"),c=a.MINode.valueOf(t,"fullname");let u=0;const l=a.MINode.valueOf(t,"line");l&&(u=parseInt(l)),s({address:n,fileName:o,file:c,function:i,level:r,line:u})},r)})}getStackDepth(e){return m&&this.log("stderr","getStackDepth"),new Promise((t,s)=>{this.sendCommand(`stack-info-depth --thread ${e} 10000`).then(e=>{const s=e.result("depth"),r=parseInt(s);t(r)},s)})}getStack(e,t,s){return m&&this.log("stderr","getStack"),new Promise((r,n)=>{this.sendCommand(`stack-list-frames --thread ${e} ${t} ${s}`).then(e=>{const t=e.result("stack"),s=[];t.forEach(e=>{const t=a.MINode.valueOf(e,"@frame.level"),r=a.MINode.valueOf(e,"@frame.addr"),n=a.MINode.valueOf(e,"@frame.func"),i=a.MINode.valueOf(e,"@frame.file"),o=a.MINode.valueOf(e,"@frame.fullname");let c=0;const u=a.MINode.valueOf(e,"@frame.line");u&&(c=parseInt(u));const l=parseInt(a.MINode.valueOf(e,"@frame.from"));s.push({address:r,fileName:i,file:o,function:n||l,level:t,line:c})}),r(s)},n)})}getStackVariables(e,t){return r(this,void 0,void 0,function*(){m&&this.log("stderr","getStackVariables");const s=(yield this.sendCommand(`stack-list-variables --thread ${e} --frame ${t} --simple-values`)).result("variables"),r=[];for(const e of s){const t=a.MINode.valueOf(e,"name"),s=a.MINode.valueOf(e,"value"),n=a.MINode.valueOf(e,"type");r.push({name:t,valueStr:s,type:n,raw:e})}return r})}examineMemory(e,t){return m&&this.log("stderr","examineMemory"),new Promise((s,r)=>{this.sendCommand("data-read-memory-bytes 0x"+e.toString(16)+" "+t).then(e=>{s(e.result("memory[0].contents"))},r)})}evalExpression(e,t,s){return m&&this.log("stderr","evalExpression"),new Promise((r,n)=>{const i=g.getThreadFrameStr(t,s);this.sendCommand(`data-evaluate-expression ${i} `+e).then(e=>{r(e)},n)})}varCreate(e,t="-",s="@"){return r(this,void 0,void 0,function*(){m&&this.log("stderr","varCreate");let r=null;e=e.trim(),/,[bdhonx]$/i.test(e)&&(r=e.substring(e.length-1).toLocaleLowerCase(),e=e.substring(0,e.length-2)),e=e.replace(/"/g,'\\"');const i=yield this.sendCommand(`var-create ${t} ${s} "${e}"`);let o=null;if(r&&"-"!==t){const e=yield this.sendCommand(`var-set-format ${t} ${g.FORMAT_SPEC_MAP[r]}`);o=e.result("value")}let a=i.result("");return o&&(a=a.map(e=>"value"===e[0]?["value",o]:e)),new n.VariableObject(a)})}varEvalExpression(e){return r(this,void 0,void 0,function*(){return m&&this.log("stderr","varEvalExpression"),this.sendCommand(`var-evaluate-expression ${e}`)})}varListChildren(e,t){return r(this,void 0,void 0,function*(){m&&this.log("stderr","varListChildren");const s=(yield this.sendCommand(`var-list-children --all-values ${e}`)).result("children")||[],r=[];for(const e of s){const s=new n.VariableObject(e[1]);t&&s.exp.startsWith("<anonymous ")?r.push(...yield this.varListChildren(s.name,t)):r.push(s)}return r})}static getThreadFrameStr(e,t){return(e>0?`--thread ${e} `:"")+(t>=0?`--frame ${t}`:"")}varUpdate(e="*",t,s){return r(this,void 0,void 0,function*(){return m&&this.log("stderr","varUpdate"),this.sendCommand(`var-update ${g.getThreadFrameStr(t,s)} --all-values ${e}`)})}varAssign(e,t,s,n){return r(this,void 0,void 0,function*(){return m&&this.log("stderr","varAssign"),this.sendCommand(`var-assign ${g.getThreadFrameStr(s,n)} ${e} ${t}`)})}logNoNewLine(e,t){this.emit("msg",e,t)}log(e,t){this.emit("msg",e,"\n"===t[t.length-1]?t:t+"\n")}sendUserInput(e){return e.startsWith("-")?this.sendCommand(e.substr(1)):this.sendCommand(`interpreter-exec console "${e}"`)}sendRaw(e){(this.printCalls||m)&&this.log("log",e),e.includes("undefined")&&console.log(e),this.process.stdin.write(e+"\n")}getCurrentToken(){return this.currentToken}sendCommand(e,t=!1){const s=this.currentToken++;return new Promise((r,i)=>{this.handlers[s]=s=>{s&&s.resultRecords&&"error"===s.resultRecords.resultClass?t?(this.log("stderr",`WARNING: Error executing command '${e}'`),r(s)):i(new n.MIError(s.result("msg")||"Internal error",e)):r(s)},this.sendRaw(s+"-"+e)})}isReady(){return!!this.process}}g.FORMAT_SPEC_MAP={b:"binary",d:"decimal",h:"hexadecimal",o:"octal",n:"natural",x:"hexadecimal"},t.MI2=g},function(e,t,s){"use strict";function r(e,t){let s=0;const r=e+t-1;for(let t=e;t<=r;t++)s=(s|1<<t)>>>0;return s}function n(e){return/^0b([01]+)$/i.test(e)?parseInt(e.substring(2),2):/^0x([0-9a-f]+)$/i.test(e)?parseInt(e.substring(2),16):/^[0-9]+/i.test(e)?parseInt(e,10):/^#[0-1]+/i.test(e)?parseInt(e.substring(1),2):void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.hexFormat=function(e,t=8,s=!0){let r=e.toString(16);for(;r.length<t;)r="0"+r;return s?"0x"+r:r},t.binaryFormat=function(e,t=0,s=!0,r=!1){let n=(e>>>0).toString(2);for(;n.length<t;)n="0"+n;if(r){const e=4-n.length%4;for(let t=0;t<e;t++)n="0"+n;const t=n.match(/[01]{4}/g);n=(n=t.join(" ")).substring(e)}return s?"0b"+n:n},t.createMask=r,t.extractBits=function(e,t,s){return(e&r(t,s))>>>t>>>0},t.parseInteger=n,t.parseDimIndex=function(e,t){if(-1!==e.indexOf(",")){const s=e.split(",").map(e=>e.trim());if(s.length!==t)throw new Error("dimIndex Element has invalid specification.");return s}if(/^([0-9]+)\-([0-9]+)$/i.test(e)){const s=e.split("-").map(e=>n(e)),r=s[0];if(s[1]-r+1<t)throw new Error("dimIndex Element has invalid specification.");const i=[];for(let e=0;e<t;e++)i.push(`${r+e}`);return i}if(/^[a-zA-Z]\-[a-zA-Z]$/.test(e)){const s=e.charCodeAt(0);if(e.charCodeAt(2)-s+1<t)throw new Error("dimIndex Element has invalid specification.");const r=[];for(let e=0;e<t;e++)r.push(String.fromCharCode(s+e));return r}return[]}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(5),n=s(2),i=s(0),o=s(15),a=s(16);class c extends i.EventEmitter{constructor(e,t,s,r,n){super(),this.cwd=e,this.application=t,this.args=s,this.initMatch=r,this.port=n,this.outBuffer="",this.errBuffer=""}init(){return new Promise((e,t)=>{null!==this.application?(this.initResolve=e,this.initReject=t,this.process=r.spawn(this.application,this.args,{cwd:this.cwd}),this.process.stdout.on("data",this.onStdout.bind(this)),this.process.stderr.on("data",this.onStderr.bind(this)),this.process.on("exit",this.onExit.bind(this)),this.process.on("error",this.onError.bind(this)),"number"==typeof this.port&&this.port>0&&a.TcpPortScanner.waitForPortOpen(this.port,c.LOCALHOST,!0,50,c.SERVER_TIMEOUT-1e3).then(()=>{this.initResolve&&(this.initResolve(!0),this.initReject=null,this.initResolve=null)}).catch(e=>{}),-1!==this.application.indexOf("st-util")&&"win32"===n.platform()&&o.setTimeout(()=>{this.initResolve&&(this.initResolve(!0),this.initReject=null,this.initResolve=null)},500),null==this.initMatch&&o.setTimeout(()=>{this.initResolve&&(this.initResolve(!0),this.initReject=null,this.initResolve=null)},1e3)):e()})}exit(){this.process&&(this.process.kill(),this.process=null)}onExit(e,t){this.emit("exit",e,t)}onError(e){this.initReject&&(this.initReject(e),this.initReject=null,this.initResolve=null),this.emit("launcherror",e)}onStdout(e){this.outBuffer+="string"==typeof e?e:e.toString("utf8"),this.initResolve&&this.initMatch.test(this.outBuffer)&&(this.initResolve(!0),this.initResolve=null,this.initReject=null);const t=this.outBuffer.lastIndexOf("\n");-1!==t&&(this.emit("output",this.outBuffer.substring(0,t)),this.outBuffer=this.outBuffer.substring(t+1))}onStderr(e){this.errBuffer+="string"==typeof e?e:e.toString("utf8"),this.initResolve&&this.initMatch.test(this.errBuffer)&&(this.initResolve(!0),this.initResolve=null,this.initReject=null);const t=this.errBuffer.lastIndexOf("\n");-1!==t&&(this.emit("output",this.errBuffer.substring(0,t)),this.errBuffer=this.errBuffer.substring(t+1))}}c.SERVER_TIMEOUT=1e4,c.LOCALHOST="0.0.0.0",t.GDBServer=c},function(e,t,s){"use strict";t.check=d,t.waitUntilFreeOnHost=function(e,t,s,n){var i;r.obj(e)?(i=e).inUse=!1:i=l(e,t,!1,s,n);return h(i)},t.waitUntilFree=function(e,t,s){var n;r.obj(e)?((n=e).host="127.0.0.1",n.inUse=!1):n=l(e,"127.0.0.1",!1,t,s);return h(n)},t.waitUntilUsedOnHost=p,t.waitUntilUsed=function(e,t,s){var n;r.obj(e)?((n=e).host="127.0.0.1",n.inUse=!0):n=l(e,"127.0.0.1",!0,t,s);return p(n)},t.waitForStatus=h;var r=s(31),n=s(10),i=s(17),o=s(36)("tcp-port-used"),a=2e3,c=250;function u(){var e,t,s=new Promise(function(s,r){e=s,t=r});return{resolve:e,reject:t,promise:s}}function l(e,t,s,r,n){var i={};return i.port=e,i.host=t,i.inUse=s,i.retryTimeMs=r,i.timeOutMs=n,i}function d(e,t){var s,a,c=u(),d=!0;if(a=r.obj(e)?e:l(e,t),!r.port(a.port))return o("Error invalid port: "+i.inspect(a.port)),c.reject(new Error("invalid port: "+i.inspect(a.port))),c.promise;function h(){s&&(s.removeAllListeners("connect"),s.removeAllListeners("error"),s.end(),s.destroy(),s.unref())}return r.nullOrUndefined(a.host)&&(o("set host address to default 127.0.0.1"),a.host="127.0.0.1"),(s=new n.Socket).once("connect",function(){c.resolve(d),h()}),s.once("error",function(e){"ECONNREFUSED"!==e.code?c.reject(e):(d=!1,c.resolve(d)),h()}),s.connect({port:a.port,host:a.host},function(){}),c.promise}function h(e,t,s,n,i){var h,p,f,m=u(),g=!1;if(f=r.obj(e)?e:l(e,t,s,n,i),!r.bool(f.inUse))return m.reject(new Error("inUse must be a boolean")),m.promise;function b(){h&&clearTimeout(h),p&&clearTimeout(p)}return r.positiveInt(f.retryTimeMs)||(f.retryTimeMs=c,o("set retryTime to default "+c+"ms")),r.positiveInt(f.timeOutMs)||(f.timeOutMs=a,o("set timeOutMs to default "+a+"ms")),h=setTimeout(function(){g=!0,b(),m.reject(new Error("timeout"))},f.timeOutMs),function e(){d(f.port,f.host).then(function(t){if(!g)return t===f.inUse?(m.resolve(),void b()):void(p=setTimeout(function(){e()},f.retryTimeMs))},function(e){g||(m.reject(e),b())})}(),m.promise}function p(e,t,s,n){var i;return r.obj(e)?(i=e).inUse=!0:i=l(e,t,!0,s,n),h(i)}},function(e,t,s){"use strict";const r={}.hasOwnProperty,n={}.toString,i=t,o=s(32),a=s(33);i.version=s(34).version,i.browser=function(){return!i.node()&&"undefined"!=typeof window&&"[object global]"===n.call(window)},i.defined=function(e){return void 0!==e},i.def=i.defined,i.nodejs=function(){return process&&process.hasOwnProperty("version")&&process.hasOwnProperty("versions")},i.node=i.nodejs,i.undefined=function(e){return void 0===e},i.udef=i.undef=i.undefined,i.array=function(e){return"[object Array]"===n.call(e)},i.arr=i.ary=i.arry=i.array,i.arrayLike=function(e){return!i.nullOrUndef(e)&&(void 0!==e&&r.call(e,"length")&&isFinite(e.length))},i.arrLike=i.arryLike=i.aryLike=i.arraylike=i.arrayLike,i.arguments=function(e){return"[object Arguments]"===n.call(e)},i.args=i.arguments,i.boolean=function(e){return"[object Boolean]"===n.call(e)},i.bool=i.boolean,i.buffer=function(e){return i.nodejs()&&Buffer&&Buffer.hasOwnProperty("isBuffer")&&Buffer.isBuffer(e)},i.buff=i.buf=i.buffer,i.date=function(e){return"[object Date]"===n.call(e)},i.error=function(e){return"[object Error]"===n.call(e)},i.err=i.error,i.false=function(e){return!1===e},i.function=function(e){return i.syncFunction(e)||i.asyncFunction(e)},i.fun=i.func=i.function,i.asyncFunction=function(e){return"[object AsyncFunction]"===n.call(e)},i.asyncFun=i.asyncFunc=i.asyncFunction,i.syncFunction=function(e){return"[object Function]"===n.call(e)},i.syncFun=i.syncFunc=i.syncFunction,i.null=function(e){return null===e},i.nullOrUndefined=function(e){return null==e},i.nullOrUndef=i.nullOrUndefined,i.number=function(e){return"[object Number]"===n.call(e)},i.num=i.number,i.object=function(e){return"[object Object]"===n.call(e)},i.obj=i.object,i.regExp=function(e){return"[object RegExp]"===n.call(e)},i.re=i.regexp=i.regExp,i.string=function(e){return"[object String]"===n.call(e)},i.str=i.string,i.true=function(e){return!0===e};var c=new RegExp("[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}","i");i.uuid=function(e){return c.test(e)},i.equal=function(e,t){var s=n.call(e);return typeof e==typeof t&&(s===n.call(t)&&("[object Object]"===s||"[object Array]"===s?o(e,t):"[object Function]"===s?e.prototype===t.prototype:"[object Date]"===s?e.getTime()===t.getTime():e===t))},i.objEquals=i.eq=i.equal;var u={boolean:1,number:1,string:1,undefined:1};i.hosted=function(e,t){if(i.nullOrUndef(e))return!1;var s=typeof t[e];return"object"===s?!!t[e]:!u[s]},i.instanceOf=function(e,t){return!i.nullOrUndef(e)&&!i.nullOrUndef(t)&&e instanceof t},i.instOf=i.instanceof=i.instanceOf,i.objectInstanceOf=function(e,t){try{return"[object Object]"===n.call(e)&&e instanceof t}catch(e){return!1}},i.instOf=i.instanceOf=i.objInstOf=i.objectInstanceOf,i.type=function(e,t){return typeof e===t},i.a=i.type,i.empty=function(e){var t=n.call(e);if("[object Array]"===t||"[object Arguments]"===t)return 0===e.length;if("[object Object]"===t){for(var s in e)if(r.call(e,s))return!1;return!0}return"[object String]"===t&&""===e},i.emptyArguments=function(e){return"[object Arguments]"===n.call(e)&&0===e.length},i.noArgs=i.emptyArgs=i.emptyArguments,i.emptyArray=function(e){return"[object Array]"===n.call(e)&&0===e.length},i.emptyArry=i.emptyAry=i.emptyArray,i.emptyArrayLike=function(e){return 0===e.length},i.emptyArrLike=i.emptyArrayLike,i.emptyString=function(e){return i.string(e)&&0===e.length},i.emptyStr=i.emptyString,i.nonEmptyArray=function(e){return"[object Array]"===n.call(e)&&e.length>0},i.nonEmptyArr=i.nonEmptyArry=i.nonEmptyAry=i.nonEmptyArray,i.nonEmptyObject=function(e){return"[object Object]"===n.call(e)&&Object.keys(e).length>0},i.nonEmptyObj=i.nonEmptyObject,i.emptyObject=function(e){return"[object Object]"===n.call(e)&&0===Object.keys(e).length},i.emptyObj=i.emptyObject,i.nonEmptyString=function(e){return i.string(e)&&e.length>0},i.nonEmptyStr=i.nonEmptyString,i.even=function(e){return"[object Number]"===n.call(e)&&e%2==0},i.decimal=function(e){return"[object Number]"===n.call(e)&&e%1!=0},i.dec=i.decNum=i.decimal,i.integer=function(e){return"[object Number]"===n.call(e)&&e%1==0},i.int=i.integer,i.notANumber=function(e){return!i.num(e)||e!=e},i.nan=i.notANum=i.notANumber,i.odd=function(e){return!i.decimal(e)&&"[object Number]"===n.call(e)&&e%2!=0},i.oddNumber=i.oddNum=i.odd,i.positiveNumber=function(e){return"[object Number]"===n.call(e)&&e>0},i.pos=i.positive=i.posNum=i.positiveNum=i.positiveNumber,i.negativeNumber=function(e){return"[object Number]"===n.call(e)&&e<0},i.neg=i.negNum=i.negativeNum=i.negativeNumber,i.negativeInteger=function(e){return"[object Number]"===n.call(e)&&e%1==0&&e<0},i.negativeInt=i.negInt=i.negativeInteger,i.positiveInteger=function(e){return"[object Number]"===n.call(e)&&e%1==0&&e>0},i.posInt=i.positiveInt=i.positiveInteger,i.divisibleBy=function(e,t){return 0!==e&&("[object Number]"===n.call(e)&&0!==t&&e%t==0)},i.divBy=i.divisBy=i.divisibleBy,i.greaterOrEqualTo=function(e,t){return e>=t},i.greaterOrEqual=i.ge=i.greaterOrEqualTo,i.greaterThan=function(e,t){return e>t},i.gt=i.greaterThan,i.lessThanOrEqualTo=function(e,t){return e<=t},i.lessThanOrEq=i.lessThanOrEqual=i.le=i.lessThanOrEqualTo,i.lessThan=function(e,t){return e<t},i.lt=i.lessThan,i.maximum=function(e,t){if(!i.arrayLike(t)||!i.number(e))return!1;for(var s=t.length;--s>-1;)if(e<t[s])return!1;return!0},i.max=i.maximum,i.minimum=function(e,t){if(!i.arrayLike(t)||!i.number(e))return!1;for(var s=t.length;--s>-1;)if(e>t[s])return!1;return!0},i.min=i.minimum,i.within=function(e,t,s){return e>=t&&e<=s},i.withIn=i.within,i.prettyClose=function(e,t,s){return!(!i.number(e)||!i.number(t))&&(!(i.defined(s)&&!i.posInt(s))&&(i.undefined(s)&&(s=2),e.toFixed(s)===t.toFixed(s)))},i.closish=i.near=i.prettyClose,i.dnsAddress=function(e){return!!i.nonEmptyStr(e)&&(!(e.length>255)&&(!d.test(e)&&!!l.test(e)))},i.dnsAddr=i.dns=i.dnsAddress;var l=/^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])(\.([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9]))*$/,d=/^([0-9]|[0-9][0-9\-]{0,61}[0-9])(\.([0-9]|[0-9][0-9\-]{0,61}[0-9]))*$/;i.emailAddress=function(e){return!!i.nonEmptyStr(e)&&h.test(e)},i.email=i.emailAddr=i.emailAddress;var h=/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/;i.ipv4Address=function(e){if(!i.nonEmptyStr(e))return!1;if(e.length>15)return!1;var t=e.split(".");if(!i.array(t)||4!==t.length)return!1;for(var s=0;s<t.length;s++){var r=parseInt(t[s],10);if(isNaN(r))return!1;if(r<0||r>255)return!1}return!0},i.ipv4=i.ipv4Addr=i.ipv4Address,i.ipv6Address=function(e){return!!i.nonEmptyStr(e)&&a.v6({extract:!0}).test(e)},i.ipv6=i.ipv6Addr=i.ipv6Address,i.ipAddress=function(e){return!!i.nonEmptyStr(e)&&(i.ipv4Address(e)||i.ipv6Address(e))},i.ip=i.ipAddr=i.ipAddress,i.hostAddress=function(e){return!!i.nonEmptyStr(e)&&(i.dns(e)||i.ipv4(e)||i.ipv6(e))},i.host=i.hostIp=i.hostAddr=i.hostAddress,i.port=function(e){return!(!i.num(e)||i.negativeInt(e)||e>65535)},i.systemPort=function(e){return!!(i.port(e)&&e<1024)},i.sysPort=i.systemPort,i.userPort=function(e){return!!(i.port(e)&&e>1023)},i.creditCardNumber=function(e){if(!i.str(e))return!1;var t,s,r=e.split("");for(t=r.length-1,s=1;t>-1;t--,s++)s%2==0&&(r[t]*=2);e=r.join("");var n=0;for(t=0;t<e.length;t++)n+=Math.floor(e[t]);return n%10==0},i.creditCard=i.creditCardNum=i.creditCardNumber,i.americanExpressCardNumber=function(e){if(!i.str(e)||15!==e.length)return!1;var t=Math.floor(e.slice(0,2));return(34===t||37===t)&&!!i.creditCardNumber(e)},i.amexCard=i.amexCardNum=i.americanExpressCardNumber,i.chinaUnionPayCardNumber=function(e){if(!i.str(e)||e.length<16&&e.length>19)return!1;var t=Math.floor(e.slice(0,2));return 62===t||88===t},i.chinaUnion=i.chinaUnionPayCard=i.chinaUnionPayCardNumber,i.dinersClubCarteBlancheCardNumber=function(e){if(!i.str(e)||14!==e.length)return!1;var t=Math.floor(e.slice(0,3));return!(t<300||t>305)&&!!i.creditCardNumber(e)},i.dinersClubCB=i.dinersClubCarteBlancheCard=i.dinersClubCarteBlancheCardNumber,i.dinersClubInternationalCardNumber=function(e){if(!i.str(e)||14!==e.length)return!1;var t=Math.floor(e.slice(0,3)),s=Math.floor(e.slice(0,2));return(!(t<300||t>305)||309===t||36===s||!(s<38||s>39))&&!!i.creditCardNumber(e)},i.dinersClubInt=i.dinersClubInternationalCard=i.dinersClubInternationalCardNumber,i.dinersClubUSACanadaCardNumber=function(e){if(!i.str(e)||16!==e.length)return!1;var t=Math.floor(e.slice(0,2));return(54===t||55===t)&&!!i.creditCardNumber(e)},i.dinersClub=i.dinersClubUSACanCard=i.dinersClubUSACanadaCardNumber,i.discoverCardNumber=function(e){if(!i.str(e)||16!==e.length)return!1;var t=Math.floor(e.slice(0,6)),s=Math.floor(e.slice(0,3));return("6011"===e.slice(0,4)||!(t<622126||t>622925)||!(s<644||s>649)||"65"===e.slice(0,2))&&!!i.creditCardNumber(e)},i.discover=i.discoverCard=i.discoverCardNumber,i.instaPaymentCardNumber=function(e){if(!i.str(e)||16!==e.length)return!1;var t=Math.floor(e.slice(0,3));return!(t<637||t>639)&&!!i.creditCardNumber(e)},i.instaPayment=i.instaPaymentCardNumber,i.jcbCardNumber=function(e){if(!i.str(e)||16!==e.length)return!1;var t=Math.floor(e.slice(0,4));return!(t<3528||t>3589)&&!!i.creditCardNumber(e)},i.jcb=i.jcbCard=i.jcbCardNumber,i.laserCardNumber=function(e){if(!i.str(e)||e.length<16&&e.length>19)return!1;var t=Math.floor(e.slice(0,4));return-1!==[6304,6706,6771,6709].indexOf(t)&&!!i.creditCardNumber(e)},i.laser=i.laserCard=i.laserCardNumber,i.maestroCardNumber=function(e){if(!i.str(e)||e.length<12||e.length>19)return!1;var t=e.slice(0,4);return-1!==["5018","5020","5038","5612","5893","6304","6759","6761","6762","6763","0604","6390"].indexOf(t)&&!!i.creditCardNumber(e)},i.maestro=i.maestroCard=i.maestroCardNumber,i.dankortCardNumber=function(e){return!(!i.str(e)||16!==e.length)&&("5019"===e.slice(0,4)&&!!i.creditCardNumber(e))},i.dankort=i.dankortCard=i.dankortCardNumber,i.masterCardCardNumber=function(e){if(!i.str(e)||16!==e.length)return!1;var t=Math.floor(e.slice(0,2));return!(t<50||t>55)&&!!i.creditCardNumber(e)},i.masterCard=i.masterCardCard=i.masterCardCardNumber,i.visaCardNumber=function(e){return!(!i.str(e)||13!==e.length&&16!==e.length)&&("4"===e.slice(0,1)&&!!i.creditCardNumber(e))},i.visa=i.visaCard=i.visaCardNumber,i.visaElectronCardNumber=function(e){if(!i.str(e)||16!==e.length)return!1;var t=Math.floor(e.slice(0,4));return("417500"===e.slice(0,6)||-1!==[4026,4405,4508,4844,4913,4917].indexOf(t))&&(i.creditCardNumber(e),!1)},i.visaElectron=i.visaElectronCard=i.visaElectronCardNumber;var p=/^[0-9a-fA-F]{24}$/;i.mongoId=i.objectId=i.objId=function(e){return Boolean(e)&&!Array.isArray(e)&&p.test(String(e))},i.matching=i.match=i.inArgs=function(e){if(arguments.length<2)return!1;for(var t=!1,s=1;s<arguments.length;s++){var r=i.equal(e,arguments[s]);t=t||r}return t},i.streetAddress=function(e){if(!i.str(e))return!1;return/\b\d+[\s](?:[A-Za-z0-9.-]+[\s]+)+\b(ALLEY|ALY|AVENUE|AVE|BEND|BND|BLUFFS?|BLFS?|BOULEVARD|BLVD|BRANCH|BR|CENTERS?|CTRS?|CIRCLES?|CIRS?|CLIFFS?|CLFS?|COURTS?|CTS?|COVES?|CVS?|CREEK|CRK|CRESCENT|CRES|CREST|CRST|CROSSING|XING|DRIVES?|DRS?|EXPRESSWAY|EXPY|FREEWAY|FWY|HEIGHTS|HTS|HIGHWAY|HWY|HILLS?|HLS?|LANE|LN|LOOP|MANORS?|MNRS?|MOTORWAY|MTWY|MOUNT|MT|PARKS?|PARKWAYS?|PKWY|PASS|PLACE|PL|PLAZA|PLZ|POINTS?|PTS?|RIDGES?|RDGS?|ROADS?|RDS?|ROUTE|RTE?|SHOALS?|SHLS?|SHORES?|SHRS?|SPRINGS?|SPGS?|SPURS?|STREETS?|STS?|SUMMIT|SMT|TERRACE|TER|THROUGHWAY|TRWY|TRAFFICWAY|TRFY|TRAIL|TRL|TURNPIKE|TPKE|VALLEYS?|VLYS?|WAYS?)+(?:[\.\-\s\,]?)*((APARTMENT|APT|APPT|#|NUMBER|NUM|FLOOR|FL|\s)?(\d)*)\b/gi.test(e)},i.street=i.address=i.streetAddress,i.zipCode=function(e){if(i.undefined(e)||!i.string(e)&&!i.number(e))return!1;return/^\d{5}(?:-\d{4})?$/.test(e)},i.zip=i.zipCode,i.phoneNumber=function(e){if(!i.string(e))return!1;return/(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:(\(?)(?:(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\)?)\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})/g.test(e)},i.phone=i.phoneNumber;var f=s(35);i.url=function(e){return f(e)},i.uri=i.url,i.enumerator=function(e,t){var s=!1;if(!i.defined(e)||!i.defined(t)||!i.arrayLike(t))return s;for(var r=0,n=t.length;r<n;r++)if(i.equal(e,t[r])){s=!0;break}return s},i.enum=i.inArray=i.enumerator},function(e,t){var s=Array.prototype.slice,r="function"==typeof Object.keys?Object.keys:function(e){var t=[];for(var s in e)t.push(s);return t},n=e.exports=function(e,t){return 0===e&&0===t?1/e==1/t:e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():a(e)?a(t):"object"!=typeof e&&"object"!=typeof t?e==t:function(e,t){if(i(e)||i(t))return!1;if(e.prototype!==t.prototype)return!1;if(o(e))return!!o(t)&&(e=s.call(e),t=s.call(t),n(e,t));try{var a,c,u=r(e),l=r(t)}catch(e){return!1}if(u.length!=l.length)return!1;for(u.sort(),l.sort(),c=u.length-1;c>=0;c--)if(u[c]!=l[c])return!1;for(c=u.length-1;c>=0;c--)if(a=u[c],!n(e[a],t[a]))return!1;return!0}(e,t))};function i(e){return null==e}function o(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function a(e){return"number"==typeof e&&e!=e}},function(e,t,s){"use strict";const r="(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}",n="[0-9a-fA-F]{1,4}",i=`\n(\n(?:${n}:){7}(?:${n}|:)|                                // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${n}:){6}(?:${r}|:${n}|:)|                         // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${n}:){5}(?::${r}|(:${n}){1,2}|:)|                 // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${n}:){4}(?:(:${n}){0,1}:${r}|(:${n}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${n}:){3}(?:(:${n}){0,2}:${r}|(:${n}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${n}:){2}(?:(:${n}){0,3}:${r}|(:${n}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${n}:){1}(?:(:${n}){0,4}:${r}|(:${n}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::((?::${n}){0,5}:${r}|(?::${n}){1,7}|:))           // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(%[0-9a-zA-Z]{1,})?                                           // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=e.exports=e=>e&&e.exact?new RegExp(`(?:^${r}$)|(?:^${i}$)`):new RegExp(`(?:${r})|(?:${i})`,"g");o.v4=e=>e&&e.exact?new RegExp(`^${r}$`):new RegExp(r,"g"),o.v6=e=>e&&e.exact?new RegExp(`^${i}$`):new RegExp(i,"g")},function(e){e.exports={_args:[["is2@2.0.1","/Users/hdm/cypress/vscode/cortex-debug.master/cortex-debug"]],_from:"is2@2.0.1",_id:"is2@2.0.1",_inBundle:!1,_integrity:"sha512-+WaJvnaA7aJySz2q/8sLjMb2Mw14KTplHmSwcSpZ/fWJPkUmqw3YTzSWbPJ7OAwRvdYTWF2Wg+yYJ1AdP5Z8CA==",_location:"/is2",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"is2@2.0.1",name:"is2",escapedName:"is2",rawSpec:"2.0.1",saveSpec:null,fetchSpec:"2.0.1"},_requiredBy:["/tcp-port-used"],_resolved:"https://registry.npmjs.org/is2/-/is2-2.0.1.tgz",_spec:"2.0.1",_where:"/Users/hdm/cypress/vscode/cortex-debug.master/cortex-debug",author:{name:"Enrico Marino",email:"enrico.marino@email.com"},bugs:{url:"http://github.com/stdarg/is/issues"},dependencies:{"deep-is":"^0.1.3","ip-regex":"^2.1.0","is-url":"^1.2.2"},description:"A type checking library where each exported function returns either true or false and does not throw. Also added tests.",devDependencies:{jsdom:"0.5.0",mocha:"5.0.1",mongodb:"3.0.2"},engines:{node:">=v0.10.0"},homepage:"http://github.com/stdarg/is2",keywords:["type","check","checker","checking","utilities","network","networking","credit","card","validation"],license:"MIT",main:"./index.js",maintainers:"Edmond Meinfelder <edmond@stdarg.com>, Chris Oyler <christopher.oyler@gmail.com>",name:"is2",repository:{type:"git",url:"git+ssh://git@github.com/stdarg/is2.git"},scripts:{test:"mocha -C --reporter list tests.js"},tags:["type","check","checker","checking","utilities","network","networking","credit","card","validation"],version:"2.0.1"}},function(e,t){e.exports=function(e){if("string"!=typeof e)return!1;var t=e.match(s);if(!t)return!1;var i=t[1];if(!i)return!1;if(r.test(i)||n.test(i))return!0;return!1};var s=/^(?:\w+:)?\/\/(\S+)$/,r=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,n=/^[^\s\.]+\.\S{2,}$/},function(e,t,s){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=s(37):e.exports=s(39)},function(e,t,s){t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const s="color: "+this.color;t.splice(1,0,s,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(n=r))}),t.splice(n,0,s)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=s(18)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},function(e,t){var s=1e3,r=60*s,n=60*r,i=24*n,o=7*i,a=365.25*i;function c(e,t,s,r){var n=t>=1.5*s;return Math.round(e/s)+" "+r+(n?"s":"")}e.exports=function(e,t){t=t||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var c=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*a;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&!1===isNaN(e))return t.long?function(e){var t=Math.abs(e);if(t>=i)return c(e,t,i,"day");if(t>=n)return c(e,t,n,"hour");if(t>=r)return c(e,t,r,"minute");if(t>=s)return c(e,t,s,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=n)return Math.round(e/n)+"h";if(t>=r)return Math.round(e/r)+"m";if(t>=s)return Math.round(e/s)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,s){const r=s(40),n=s(17);t.init=function(e){e.inspectOpts={};const s=Object.keys(t.inspectOpts);for(let r=0;r<s.length;r++)e.inspectOpts[s[r]]=t.inspectOpts[s[r]]},t.log=function(...e){return process.stderr.write(n.format(...e)+"\n")},t.formatArgs=function(s){const{namespace:r,useColors:n}=this;if(n){const t=this.color,n="[3"+(t<8?t:"8;5;"+t),i=`  ${n};1m${r} [0m`;s[0]=i+s[0].split("\n").join("\n"+i),s.push(n+"m+"+e.exports.humanize(this.diff)+"[0m")}else s[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+r+" "+s[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{const e=s(41);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{const s=t.substring(6).toLowerCase().replace(/_([a-z])/g,(e,t)=>t.toUpperCase());let r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[s]=r,e},{}),e.exports=s(18)(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts).replace(/\s*\n\s*/g," ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts)}},function(e,t){e.exports=require("tty")},function(e,t,s){"use strict";const r=s(2),n=s(42),i=process.env;let o;function a(e){return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(function(e){if(!1===o)return 0;if(n("color=16m")||n("color=full")||n("color=truecolor"))return 3;if(n("color=256"))return 2;if(e&&!e.isTTY&&!0!==o)return 0;const t=o?1:0;if("win32"===process.platform){const e=r.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in i)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(e=>e in i)||"codeship"===i.CI_NAME?1:t;if("TEAMCITY_VERSION"in i)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(i.TEAMCITY_VERSION)?1:0;if("truecolor"===i.COLORTERM)return 3;if("TERM_PROGRAM"in i){const e=parseInt((i.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(i.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(i.TERM)?2:/^screen|^xterm|^vt100|^rxvt|color|ansi|cygwin|linux/i.test(i.TERM)?1:"COLORTERM"in i?1:(i.TERM,t)}(e))}n("no-color")||n("no-colors")||n("color=false")?o=!1:(n("color")||n("colors")||n("color=true")||n("color=always"))&&(o=!0),"FORCE_COLOR"in i&&(o=0===i.FORCE_COLOR.length||0!==parseInt(i.FORCE_COLOR,10)),e.exports={supportsColor:a,stdout:a(process.stdout),stderr:a(process.stderr)}},function(e,t,s){"use strict";e.exports=(e,t)=>{t=t||process.argv;const s=e.startsWith("-")?"":1===e.length?"-":"--",r=t.indexOf(s+e),n=t.indexOf("--");return-1!==r&&(-1===n||r<n)}},function(e,t,s){"use strict";var r=s(5).exec,n=s(5).execSync,i=s(3),o=s(1),a=i.access,c=i.accessSync,u=i.constants||i,l="win32"==process.platform,d=function(e,t,s){!function(e,t){a(e,u.F_OK,function(e){t(!e)})}(e,function(n){if(n)!function(e,t){a(e,u.F_OK|u.X_OK,function(e){t(null,!e)})}(e,s);else r("command -v "+t+" 2>/dev/null && { echo >&1 "+t+"; exit 0; }",function(e,t,r){s(null,!!t)})})},h=function(e,t){if(function(e){try{return c(e,u.F_OK),!1}catch(e){return!0}}(e))try{return!!n("command -v "+t+" 2>/dev/null && { echo >&1 "+t+"; exit 0; }")}catch(e){return!1}return function(e){try{return c(e,u.F_OK|u.X_OK),!0}catch(e){return!1}}(e)},p=function(e){return/[^A-Za-z0-9_\/:=-]/.test(e)&&(e=(e="'"+e.replace(/'/g,"'\\''")+"'").replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),e};l&&(p=function(e){return/[\\]/.test(e)?'"'+o.dirname(e)+'"'+":"+('"'+o.basename(e)+'"'):'"'+e+'"'}),e.exports=function e(t,s){var n=p(t);if(!s&&"undefined"!=typeof Promise)return new Promise(function(s,r){e(t,function(e,n){n?s(t):r(e)})});l?function(e,t,s){/[\x00-\x1f<>:"\|\?\*]/.test(e)?s(null,!1):r("where "+t,function(e){s(null,null===e)})}(t,n,s):d(t,n,s)},e.exports.sync=function(e){var t=p(e);return l?function(e,t,s){if(/[\x00-\x1f<>:"\|\?\*]/.test(e))return!1;try{return!!n("where "+t,{stdio:[]})}catch(e){return!1}}(e,t):h(e,t)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6),n=/^([a-zA-Z_\-][a-zA-Z0-9_\-]*|\[\d+\])\s*=\s*/,i=/^[a-zA-Z_\-][a-zA-Z0-9_\-]*/,o=/^\<.+?\>/,a=/^(0x[0-9a-fA-F]+\s*)"/,c=/^0x[0-9a-fA-F]+/,u=/^0x0+\b/,l=/^(\d+) ['"]/,d=/^\d+(\.\d+)?/,h=".";t.isExpandable=function(e){let t;return 0===(e=e.trim()).length?0:e.startsWith("{...}")?2:"{"===e[0]?1:e.startsWith("true")?0:e.startsWith("false")?0:(t=u.exec(e))?0:(t=a.exec(e))?0:(t=c.exec(e))?2:(t=l.exec(e))?0:(t=d.exec(e))?0:(t=i.exec(e))?0:(t=o.exec(e),0)},t.expandValue=function(e,t,s="",p){const f=()=>{if('"'!==(t=t.trim())[0]&&"'"!==t[0])return"";let e=1,s=!0;const r=t[0];let n=t.substr(1),i=!1;for(;s;)i?i=!1:"\\"===n[0]?i=!0:n[0]===r&&(s=!1),n=n.substr(1),e++;const o=t.substr(0,e).trim();return t=t.substr(e).trim(),o},m=[s];let g,b,v,y,C,S="";const x=e=>{let t="",s="";return m.push(e),m.forEach(e=>{if(s="",""!==e)if(e.startsWith("["))t+=e;else if(t){for(;e.startsWith("*");)s+="*",e=e.substr(1);t=t+h+e}else t=e}),m.pop(),s+t};return g=()=>'"'===(t=t.trim())[0]?f():"{"===t[0]?(()=>{if("{"!==(t=t.trim())[0])return;if("}"===(t=t.substr(1).trim())[0])return t=t.substr(1).trim(),[];if(t.startsWith("...")&&"}"===(t=t.substr(3).trim())[0])return t=t.substr(1).trim(),"<...>";const e=t.indexOf("="),s=t.indexOf("{"),r=t.indexOf(",");let n=s;if(-1!==r&&r<s&&(n=r),-1!==n&&e>n||-1===e){const e=[];m.push("[0]");let s=g();m.pop(),e.push(C("[0]",s));let r=0;for(;;){if(m.push("["+ ++r+"]"),!(s=v())){m.pop();break}m.pop(),e.push(C("["+r+"]",s))}return t=t.substr(1).trim(),e}let i=y(!0);if(i){const e=[];for(e.push(i);i=b(!0);)e.push(i);return t=t.substr(1).trim(),e}})():(()=>{let e,s;return 0===(t=t.trim()).length?e=void 0:t.startsWith("true")?(e="true",t=t.substr(4).trim()):t.startsWith("false")?(e="false",t=t.substr(5).trim()):(s=u.exec(t))?(e="<nullptr>",t=t.substr(s[0].length).trim()):(s=a.exec(t))?(t=t.substr(s[1].length).trim(),e=f()):(s=c.exec(t))?(e="*"+s[0],t=t.substr(s[0].length).trim()):(s=l.exec(t))?(e=s[1],t=t.substr(s[0].length-1),e+=" "+f()):(s=d.exec(t))?(e=s[0],t=t.substr(s[0].length).trim()):(s=i.exec(t))?(e=s[0],t=t.substr(s[0].length).trim()):(s=o.exec(t))?(e=s[0],t=t.substr(s[0].length).trim()):e=t,e})(),y=(e=!1)=>{t=t.trim();const s=n.exec(t);if(!s)return;t=t.substr(s[0].length).trim();const r=S=s[1];e&&m.push(S);const i=g();return e&&m.pop(),C(r,i)},C=(t,s)=>{let n=0;return"object"==typeof s&&(n=e(s),s="Object"),"string"==typeof s&&s.startsWith("*0x")&&(p&&"1"===r.MINode.valueOf(p,"arg")?(n=e(x("*("+t),{arg:!0}),s="<args>"):(n=e(x("*"+t)),s="Object@"+s)),"string"==typeof s&&s.startsWith("<...>")&&(n=e(x(t)),s="..."),{name:t,value:s,variablesReference:n}},v=()=>{if(","===(t=t.trim())[0])return t=t.substr(1).trim(),g()},b=(e=!1)=>{if(","===(t=t.trim())[0])return t=t.substr(1).trim(),y(e)},t=t.trim(),g()}},function(e,t,s){"use strict";var r=s(46),n=s(3),i=s(1);function o(e,t){r.some(a(e),c,t)}function a(e){var t=process.env.PATH||"",s=process.env.PATHEXT||"";return t.replace(/["]+/g,"").split(i.delimiter).map(function(t){return s.split(i.delimiter).map(function(s){return i.join(t,e+s)})}).reduce(function(e,t){return e.concat(t)})}function c(e,t){n.stat(e,function(e,s){if(e)return t(!1);t(s.isFile())})}function u(e){try{return n.statSync(e).isFile()}catch(e){return!1}}e.exports=o,o.async=o,o.sync=function(e){return a(e).some(u)},o.all=function(e,t){r.every(e,o.async,t)},o.all.sync=function(e){return e.every(o.sync)},o.some=function(e,t){r.some(e,o.async,t)},o.some.sync=function(e){return e.some(o.sync)},o.first=function(e,t){r.detect(e,o.async,function(e){t(e||!1)})},o.first.sync=function(e){var t=e.filter(o.sync);return!!t.length&&t[0]},o.every=o.all,o.any=o.some},function(e,t,s){var r;
/*!
 * async
 * https://github.com/caolan/async
 *
 * Copyright 2010-2014 Caolan McMahon
 * Released under the MIT license
 */
/*!
 * async
 * https://github.com/caolan/async
 *
 * Copyright 2010-2014 Caolan McMahon
 * Released under the MIT license
 */
!function(){var s,n={};function i(){}function o(e){return e}function a(e){return!!e}function c(e){return!e}var u="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this;function l(e){return function(){if(null===e)throw new Error("Callback was already called.");e.apply(this,arguments),e=null}}function d(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}null!=u&&(s=u.async),n.noConflict=function(){return u.async=s,n};var h=Object.prototype.toString,p=Array.isArray||function(e){return"[object Array]"===h.call(e)};function f(e){return p(e)||"number"==typeof e.length&&e.length>=0&&e.length%1==0}function m(e,t){for(var s=-1,r=e.length;++s<r;)t(e[s],s,e)}function g(e,t){for(var s=-1,r=e.length,n=Array(r);++s<r;)n[s]=t(e[s],s,e);return n}function b(e){return g(Array(e),function(e,t){return t})}function v(e,t){for(var s=0;s<e.length;s++)if(e[s]===t)return s;return-1}var y=Object.keys||function(e){var t=[];for(var s in e)e.hasOwnProperty(s)&&t.push(s);return t};function C(e){var t,s,r=-1;return f(e)?(t=e.length,function(){return++r<t?r:null}):(s=y(e),t=s.length,function(){return++r<t?s[r]:null})}function S(e,t){return t=null==t?e.length-1:+t,function(){for(var s=Math.max(arguments.length-t,0),r=Array(s),n=0;n<s;n++)r[n]=arguments[n+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r)}}}function x(e){return function(t,s,r){return e(t,r)}}var E="function"==typeof setImmediate&&setImmediate,R=E?function(e){E(e)}:function(e){setTimeout(e,0)};function w(e){return function(t,s,r){r=d(r||i);var n=C(t=t||[]);if(e<=0)return r(null);var o=!1,a=0,c=!1;!function i(){if(o&&a<=0)return r(null);for(;a<e&&!c;){var u=n();if(null===u)return o=!0,void(a<=0&&r(null));a+=1,s(t[u],u,l(function(e){a-=1,e?(r(e),c=!0):i()}))}}()}}function O(e){return function(t,s,r){return e(n.eachOf,t,s,r)}}function T(e){return function(t,s,r,n){return e(w(s),t,r,n)}}function P(e){return function(t,s,r){return e(n.eachOfSeries,t,s,r)}}function I(e,t,s,r){r=d(r||i);var n=f(t=t||[])?[]:{};e(t,function(e,t,r){s(e,function(e,s){n[t]=s,r(e)})},function(e){r(e,n)})}function M(e,t,s,r){var n=[];e(t,function(e,t,r){s(e,function(s){s&&n.push({index:t,value:e}),r()})},function(){r(g(n.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})}function F(e,t,s,r){M(e,t,function(e,t){s(e,function(e){t(!e)})},r)}function A(e,t,s){return function(r,n,i,o){function a(){o&&o(s(!1,void 0))}function c(e,r,n){if(!o)return n();i(e,function(r){o&&t(r)&&(o(s(!0,e)),o=i=!1),n()})}arguments.length>3?e(r,n,c,a):(o=i,i=n,e(r,c,a))}}function $(e,t){return t}function D(e,t,s){s=s||i;var r=f(t)?[]:{};e(t,function(e,t,s){e(S(function(e,n){n.length<=1&&(n=n[0]),r[t]=n,s(e)}))},function(e){s(e,r)})}function N(e,t,s,r){var n=[];e(t,function(e,t,r){s(e,function(e,t){n=n.concat(t||[]),r(e)})},function(e){r(e,n)})}function k(e,t,s){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");function r(e,t,s,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(e.started=!0,p(t)||(t=[t]),0===t.length&&e.idle())return n.setImmediate(function(){e.drain()});m(t,function(t){var n={data:t,callback:r||i};s?e.tasks.unshift(n):e.tasks.push(n),e.tasks.length===e.concurrency&&e.saturated()}),n.setImmediate(e.process)}function o(e,t){return function(){a-=1;var s=!1,r=arguments;m(t,function(e){m(c,function(t,r){t!==e||s||(c.splice(r,1),s=!0)}),e.callback.apply(e,r)}),e.tasks.length+a===0&&e.drain(),e.process()}}var a=0,c=[],u={tasks:[],concurrency:t,payload:s,saturated:i,empty:i,drain:i,started:!1,paused:!1,push:function(e,t){r(u,e,!1,t)},kill:function(){u.drain=i,u.tasks=[]},unshift:function(e,t){r(u,e,!0,t)},process:function(){for(;!u.paused&&a<u.concurrency&&u.tasks.length;){var t=u.payload?u.tasks.splice(0,u.payload):u.tasks.splice(0,u.tasks.length),s=g(t,function(e){return e.data});0===u.tasks.length&&u.empty(),a+=1,c.push(t[0]);var r=l(o(u,t));e(s,r)}},length:function(){return u.tasks.length},running:function(){return a},workersList:function(){return c},idle:function(){return u.tasks.length+a===0},pause:function(){u.paused=!0},resume:function(){if(!1!==u.paused){u.paused=!1;for(var e=Math.min(u.concurrency,u.tasks.length),t=1;t<=e;t++)n.setImmediate(u.process)}}};return u}function _(e){return S(function(t,s){t.apply(null,s.concat([S(function(t,s){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&m(s,function(t){console[e](t)}))})]))})}function L(e){return function(t,s,r){e(b(t),s,r)}}function q(e){return S(function(t,s){var r=S(function(s){var r=this,n=s.pop();return e(t,function(e,t,n){e.apply(r,s.concat([n]))},n)});return s.length?r.apply(this,s):r})}function j(e){return S(function(t){var s=t.pop();t.push(function(){var e=arguments;r?n.setImmediate(function(){s.apply(null,e)}):s.apply(null,e)});var r=!0;e.apply(this,t),r=!1})}"object"==typeof process&&"function"==typeof process.nextTick?n.nextTick=process.nextTick:n.nextTick=R,n.setImmediate=E?R:n.nextTick,n.forEach=n.each=function(e,t,s){return n.eachOf(e,x(t),s)},n.forEachSeries=n.eachSeries=function(e,t,s){return n.eachOfSeries(e,x(t),s)},n.forEachLimit=n.eachLimit=function(e,t,s,r){return w(t)(e,x(s),r)},n.forEachOf=n.eachOf=function(e,t,s){s=d(s||i);for(var r,n=C(e=e||[]),o=0;null!=(r=n());)o+=1,t(e[r],r,l(a));function a(e){o--,e?s(e):null===r&&o<=0&&s(null)}0===o&&s(null)},n.forEachOfSeries=n.eachOfSeries=function(e,t,s){s=d(s||i);var r=C(e=e||[]),o=r();!function i(){var a=!0;if(null===o)return s(null);t(e[o],o,l(function(e){if(e)s(e);else{if(null===(o=r()))return s(null);a?n.setImmediate(i):i()}})),a=!1}()},n.forEachOfLimit=n.eachOfLimit=function(e,t,s,r){w(t)(e,s,r)},n.map=O(I),n.mapSeries=P(I),n.mapLimit=T(I),n.inject=n.foldl=n.reduce=function(e,t,s,r){n.eachOfSeries(e,function(e,r,n){s(t,e,function(e,s){t=s,n(e)})},function(e){r(e,t)})},n.foldr=n.reduceRight=function(e,t,s,r){var i=g(e,o).reverse();n.reduce(i,t,s,r)},n.transform=function(e,t,s,r){3===arguments.length&&(r=s,s=t,t=p(e)?[]:{}),n.eachOf(e,function(e,r,n){s(t,e,r,n)},function(e){r(e,t)})},n.select=n.filter=O(M),n.selectLimit=n.filterLimit=T(M),n.selectSeries=n.filterSeries=P(M),n.reject=O(F),n.rejectLimit=T(F),n.rejectSeries=P(F),n.any=n.some=A(n.eachOf,a,o),n.someLimit=A(n.eachOfLimit,a,o),n.all=n.every=A(n.eachOf,c,c),n.everyLimit=A(n.eachOfLimit,c,c),n.detect=A(n.eachOf,o,$),n.detectSeries=A(n.eachOfSeries,o,$),n.detectLimit=A(n.eachOfLimit,o,$),n.sortBy=function(e,t,s){function r(e,t){var s=e.criteria,r=t.criteria;return s<r?-1:s>r?1:0}n.map(e,function(e,s){t(e,function(t,r){t?s(t):s(null,{value:e,criteria:r})})},function(e,t){if(e)return s(e);s(null,g(t.sort(r),function(e){return e.value}))})},n.auto=function(e,t,s){"function"==typeof arguments[1]&&(s=t,t=null),s=d(s||i);var r=y(e),o=r.length;if(!o)return s(null);t||(t=o);var a={},c=0,u=!1,l=[];function h(e){l.unshift(e)}function f(){o--,m(l.slice(0),function(e){e()})}h(function(){o||s(null,a)}),m(r,function(r){if(!u){for(var i,o=p(e[r])?e[r]:[e[r]],d=S(function(e,t){if(c--,t.length<=1&&(t=t[0]),e){var i={};l=function(e,t){i[t]=e},m(y(o=a),function(e){l(o[e],e)}),i[r]=t,u=!0,s(e,i)}else a[r]=t,n.setImmediate(f);var o,l}),g=o.slice(0,o.length-1),b=g.length;b--;){if(!(i=e[g[b]]))throw new Error("Has nonexistent dependency in "+g.join(", "));if(p(i)&&v(i,r)>=0)throw new Error("Has cyclic dependencies")}C()?(c++,o[o.length-1](d,a)):h(function e(){C()&&(c++,(t=v(l,e))>=0&&l.splice(t,1),o[o.length-1](d,a));var t})}function C(){return c<t&&(e=function(e,t){return e&&a.hasOwnProperty(t)},s=!0,m(g,function(t,r,n){s=e(s,t,r,n)}),s)&&!a.hasOwnProperty(r);var e,s}})},n.retry=function(e,t,s){var r=5,i=0,o=[],a={times:r,interval:i};var c=arguments.length;if(c<1||c>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");function u(e,t){function s(e,s){return function(r){e(function(e,t){r(!e||s,{err:e,result:t})},t)}}function r(e){return function(t){setTimeout(function(){t(null)},e)}}for(;a.times;){var i=!(a.times-=1);o.push(s(a.task,i)),!i&&a.interval>0&&o.push(r(a.interval))}n.series(o,function(t,s){s=s[s.length-1],(e||a.callback)(s.err,s.result)})}return c<=2&&"function"==typeof e&&(s=t,t=e),"function"!=typeof e&&function(e,t){if("number"==typeof t)e.times=parseInt(t,10)||r;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);e.times=parseInt(t.times,10)||r,e.interval=parseInt(t.interval,10)||i}}(a,e),a.callback=s,a.task=t,a.callback?u():u},n.waterfall=function(e,t){if(t=d(t||i),!p(e)){var s=new Error("First argument to waterfall must be an array of functions");return t(s)}if(!e.length)return t();!function e(s){return S(function(r,n){if(r)t.apply(null,[r].concat(n));else{var i=s.next();i?n.push(e(i)):n.push(t),j(s).apply(null,n)}})}(n.iterator(e))()},n.parallel=function(e,t){D(n.eachOf,e,t)},n.parallelLimit=function(e,t,s){D(w(t),e,s)},n.series=function(e,t){D(n.eachOfSeries,e,t)},n.iterator=function(e){return function t(s){function r(){return e.length&&e[s].apply(null,arguments),r.next()}return r.next=function(){return s<e.length-1?t(s+1):null},r}(0)},n.apply=S(function(e,t){return S(function(s){return e.apply(null,t.concat(s))})}),n.concat=O(N),n.concatSeries=P(N),n.whilst=function(e,t,s){if(s=s||i,e()){var r=S(function(n,i){n?s(n):e.apply(this,i)?t(r):s.apply(null,[null].concat(i))});t(r)}else s(null)},n.doWhilst=function(e,t,s){var r=0;return n.whilst(function(){return++r<=1||t.apply(this,arguments)},e,s)},n.until=function(e,t,s){return n.whilst(function(){return!e.apply(this,arguments)},t,s)},n.doUntil=function(e,t,s){return n.doWhilst(e,function(){return!t.apply(this,arguments)},s)},n.during=function(e,t,s){s=s||i;var r=S(function(t,r){t?s(t):(r.push(n),e.apply(this,r))}),n=function(e,n){e?s(e):n?t(r):s(null)};e(n)},n.doDuring=function(e,t,s){var r=0;n.during(function(e){r++<1?e(null,!0):t.apply(this,arguments)},e,s)},n.queue=function(e,t){return k(function(t,s){e(t[0],s)},t,1)},n.priorityQueue=function(e,t){function s(e,t){return e.priority-t.priority}var r=n.queue(e,t);return r.push=function(e,t,o){!function(e,t,r,o){if(null!=o&&"function"!=typeof o)throw new Error("task callback must be a function");if(e.started=!0,p(t)||(t=[t]),0===t.length)return n.setImmediate(function(){e.drain()});m(t,function(t){var a={data:t,priority:r,callback:"function"==typeof o?o:i};e.tasks.splice(function(e,t,s){for(var r=-1,n=e.length-1;r<n;){var i=r+(n-r+1>>>1);s(t,e[i])>=0?r=i:n=i-1}return r}(e.tasks,a,s)+1,0,a),e.tasks.length===e.concurrency&&e.saturated(),n.setImmediate(e.process)})}(r,e,t,o)},delete r.unshift,r},n.cargo=function(e,t){return k(e,1,t)},n.log=_("log"),n.dir=_("dir"),n.memoize=function(e,t){var s={},r={},i=Object.prototype.hasOwnProperty;t=t||o;var a=S(function(o){var a=o.pop(),c=t.apply(null,o);i.call(s,c)?n.setImmediate(function(){a.apply(null,s[c])}):i.call(r,c)?r[c].push(a):(r[c]=[a],e.apply(null,o.concat([S(function(e){s[c]=e;var t=r[c];delete r[c];for(var n=0,i=t.length;n<i;n++)t[n].apply(null,e)})])))});return a.memo=s,a.unmemoized=e,a},n.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},n.times=L(n.map),n.timesSeries=L(n.mapSeries),n.timesLimit=function(e,t,s,r){return n.mapLimit(b(e),t,s,r)},n.seq=function(){var e=arguments;return S(function(t){var s=this,r=t[t.length-1];"function"==typeof r?t.pop():r=i,n.reduce(e,t,function(e,t,r){t.apply(s,e.concat([S(function(e,t){r(e,t)})]))},function(e,t){r.apply(s,[e].concat(t))})})},n.compose=function(){return n.seq.apply(null,Array.prototype.reverse.call(arguments))},n.applyEach=q(n.eachOf),n.applyEachSeries=q(n.eachOfSeries),n.forever=function(e,t){var s=l(t||i),r=j(e);!function e(t){if(t)return s(t);r(e)}()},n.ensureAsync=j,n.constant=S(function(e){var t=[null].concat(e);return function(e){return e.apply(this,t)}}),n.wrapSync=n.asyncify=function(e){return S(function(t){var s,r,n,i=t.pop();try{s=e.apply(this,t)}catch(e){return i(e)}("function"===(n=typeof(r=s))||"object"===n&&r)&&"function"==typeof s.then?s.then(function(e){i(null,e)}).catch(function(e){i(e.message?e:new Error(e))}):i(null,s)})},e.exports?e.exports=n:void 0===(r=function(){return n}.apply(t,[]))||(e.exports=r)}()},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4),n=s(2),i=s(0),o=s(7).sync,a=["JLinkGDBServerCLExe","JLinkGDBServerCL","JLinkGDBServer"];t.JLinkServerController=class extends i.EventEmitter{constructor(){super(),this.portsNeeded=["gdbPort","swoPort","consolePort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`]}launchCommands(){return['interpreter-exec console "monitor halt"','interpreter-exec console "monitor reset"',"target-download",'interpreter-exec console "monitor reset"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor halt"','interpreter-exec console "monitor reset"']}swoCommands(){const e=[];if(this.args.swoConfig.enabled){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+r.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=0|this.args.swoConfig.swoFrequency,s=[`monitor SWO EnableTarget ${0|this.args.swoConfig.cpuFrequency} ${t} ${e} 0`,"DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable"];return s.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),s.map(e=>`interpreter-exec console "${e}"`)}serverExecutable(){if(this.args.serverpath)return this.args.serverpath;if("win32"===n.platform())return"JLinkGDBServerCL.exe";for(const e in a)if(o(e))return e;return"JLinkGDBServer"}serverArguments(){const e=this.ports.gdbPort,t=this.ports.swoPort,s=this.ports.consolePort;let r=["-if",this.args.interface,"-port",e.toString(),"-swoport",t.toString(),"-telnetport",s.toString(),"-device",this.args.device];return this.args.serialNumber?r.push("-select",`usb=${this.args.serialNumber}`):this.args.ipAddress&&r.push("-select",`ip=${this.args.ipAddress}`),this.args.rtos&&r.push("-rtos",this.args.rtos),this.args.jlinkscript&&r.push("-jlinkscriptfile",this.args.jlinkscript),this.args.serverArgs&&(r=r.concat(this.args.serverArgs)),r}initMatch(){return/Waiting for GDB connection\.\.\./g}serverLaunchStarted(){}serverLaunchCompleted(){if(this.args.swoConfig.enabled)if("probe"===this.args.swoConfig.source){const e=r.createPortName(this.args.targetProcessor,"swoPort");this.emit("event",new r.SWOConfigureEvent({type:"socket",port:this.ports[e]}))}else this.emit("event",new r.SWOConfigureEvent({type:"serial",device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency}))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4),n=s(2),i=s(19),o=s(3),a=s(5),c=s(0);t.OpenOCDServerController=class extends c.EventEmitter{constructor(){super(),this.portsNeeded=["gdbPort"],this.name="OpenOCD",this.swoPath=i.tmpNameSync()}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`]}launchCommands(){return['interpreter-exec console "monitor reset halt"',"target-download",'interpreter-exec console "monitor reset halt"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor reset halt"']}swoCommands(){const e=[];if(this.args.swoConfig.enabled){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+r.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=this.args.swoConfig.swoFrequency,s=this.args.swoConfig.cpuFrequency,n=["EnableITMAccess",`BaseSWOSetup ${Math.floor(s/t)-1}`,"SetITMId 1","ITMDWTTransferEnable","DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable","ITMGlobalEnable"];return n.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),n.map(e=>`interpreter-exec console "${e}"`)}serverExecutable(){return this.args.serverpath?this.args.serverpath:"win32"===n.platform()?"openocd.exe":"openocd"}serverArguments(){const e=this.ports.gdbPort;let t=[];t.push("-c",`gdb_port ${e}`),this.args.searchDir.forEach((e,s)=>{t.push("-s",e)}),0===this.args.searchDir.length&&t.push("-s",this.args.cwd);for(const e of this.args.openOCDPreConfigLaunchCommands||[])t.push("-c",e);if(this.args.configFiles.forEach((e,s)=>{t.push("-f",e)}),this.args.rtos){const e=i.tmpNameSync();o.writeFileSync(e,`$_TARGETNAME configure -rtos ${this.args.rtos}\n`,"utf8"),t.push("-f",e)}this.args.serverArgs&&(t=t.concat(this.args.serverArgs));const s=[];if(this.args.swoConfig.enabled){let e;"win32"===n.platform()&&(this.swoPath=this.swoPath.replace(/\\/g,"/")),e="probe"===this.args.swoConfig.source?`internal ${this.swoPath}`:"external",s.push(`tpiu config ${e} uart off ${this.args.swoConfig.cpuFrequency} ${this.args.swoConfig.swoFrequency}`)}s.length>0&&t.push("-c",s.join("; "));for(const e of this.args.openOCDLaunchCommands||[])t.push("-c",e);return t}initMatch(){return/Info\s:[^\n]*Listening on port \d+ for gdb connection/i}serverLaunchStarted(){this.args.swoConfig.enabled&&"probe"===this.args.swoConfig.source&&"win32"!==n.platform()&&(a.spawnSync("mkfifo",[this.swoPath]),this.emit("event",new r.SWOConfigureEvent({type:"fifo",path:this.swoPath})))}serverLaunchCompleted(){this.args.swoConfig.enabled&&("probe"===this.args.swoConfig.source&&"win32"===n.platform()?this.emit("event",new r.SWOConfigureEvent({type:"file",path:this.swoPath})):"probe"!==this.args.swoConfig.source&&this.emit("event",new r.SWOConfigureEvent({type:"serial",device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency})))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}},function(e,t,s){"use strict";var r="win32"===process.platform,n=r?/[^:]\\$/:/.\/$/;e.exports=function(){var e;return e=r?process.env.TEMP||process.env.TMP||(process.env.SystemRoot||process.env.windir)+"\\temp":process.env.TMPDIR||process.env.TMP||process.env.TEMP||"/tmp",n.test(e)&&(e=e.slice(0,-1)),e}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4),n=s(2),i=s(0);t.STUtilServerController=class extends i.EventEmitter{constructor(){super(),this.name="ST-Util",this.portsNeeded=["gdbPort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`]}launchCommands(){return['interpreter-exec console "monitor halt"','interpreter-exec console "monitor reset"',"target-download",'interpreter-exec console "monitor reset"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor halt"','interpreter-exec console "monitor reset"']}swoCommands(){const e=[];if(this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+r.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=this.args.swoConfig.swoFrequency,s=this.args.swoConfig.cpuFrequency,n=["EnableITMAccess",`BaseSWOSetup ${Math.floor(s/t)-1}`,"SetITMId 1","ITMDWTTransferEnable","DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable","ITMGlobalEnable"];return n.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),n.map(e=>`interpreter-exec console "${e}"`)}serverExecutable(){return this.args.serverpath?this.args.serverpath:"win32"===n.platform()?"st-util.exe":"st-util"}serverArguments(){let e=["-p",this.ports.gdbPort.toString(),"-v","--no-reset"];return this.args.v1&&e.push("--stlinkv1"),this.args.serverArgs&&(e=e.concat(this.args.serverArgs)),e}initMatch(){return/Listening at \*/g}serverLaunchStarted(){}serverLaunchCompleted(){this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source&&this.emit("event",new r.SWOConfigureEvent({type:"serial",device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency}))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4),n=s(0);t.PyOCDServerController=class extends n.EventEmitter{constructor(){super(),this.name="PyOCD",this.portsNeeded=["gdbPort","consolePort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`]}launchCommands(){return['interpreter-exec console "monitor reset halt"',"target-download",'interpreter-exec console "monitor reset halt"',"enable-pretty-printing"]}attachCommands(){return this.ports.gdbPort,['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor reset"']}swoCommands(){const e=[];if(this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+r.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=this.args.swoConfig.swoFrequency,s=this.args.swoConfig.cpuFrequency,n=["EnableITMAccess",`BaseSWOSetup ${Math.floor(s/t)-1}`,"SetITMId 1","ITMDWTTransferEnable","DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable","ITMGlobalEnable"];return n.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),n.map(e=>`interpreter-exec console "${e}"`)}serverExecutable(){return this.args.serverpath?this.args.serverpath:"pyocd-gdbserver"}serverArguments(){const e=this.ports.gdbPort,t=this.ports.consolePort;let s=["--persist","--port",e.toString(),"--telnet-port",t.toString()];return this.args.boardId&&(s.push("--board"),s.push(this.args.boardId)),this.args.targetId&&(s.push("--target"),s.push(this.args.targetId.toString())),this.args.cmsisPack&&(s.push("--pack"),s.push(this.args.cmsisPack.toString())),this.args.serverArgs&&(s=s.concat(this.args.serverArgs)),s}initMatch(){return/GDB server started (at|on) port/}serverLaunchStarted(){}serverLaunchCompleted(){this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source&&this.emit("event",new r.SWOConfigureEvent({type:"serial",device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency}))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4),n=s(0);t.BMPServerController=class extends n.EventEmitter{constructor(){super(),this.name="BMP",this.portsNeeded=[]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){const e=[`target-select extended-remote ${this.args.BMPGDBSerialPort}`];return"enable"===this.args.powerOverBMP?(e.push('interpreter-exec console "monitor tpwr enable"'),e.push('interpreter-exec console "shell sleep 0.1"')):"disable"===this.args.powerOverBMP&&e.push('interpreter-exec console "monitor tpwr disable"'),"jtag"===this.args.interface?e.push('interpreter-exec console "monitor jtag_scan"'):e.push('interpreter-exec console "monitor swdp_scan"'),e.push(`interpreter-exec console "attach ${this.args.targetId}"`,'interpreter-exec console "set mem inaccessible-by-default off"'),e}launchCommands(){return["target-download",'interpreter-exec console "SoftwareReset"',"enable-pretty-printing"]}attachCommands(){return["enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "SoftwareReset"']}swoCommands(){const e=[];if(this.args.swoConfig.enabled){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+r.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=this.args.swoConfig.swoFrequency,s=this.args.swoConfig.cpuFrequency,n=Math.floor(s/t)-1,i=[];return i.push("EnableITMAccess",`BaseSWOSetup ${n}`,"SetITMId 1","ITMDWTTransferEnable","DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable","ITMGlobalEnable"),i.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),i.map(e=>`interpreter-exec console "${e}"`)}serverExecutable(){return null}serverArguments(){return[]}initMatch(){return null}serverLaunchStarted(){}serverLaunchCompleted(){this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source&&this.emit("event",new r.SWOConfigureEvent({type:"serial",device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency}))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4),n=s(2),i=s(0);s(7).sync;t.PEServerController=class extends i.EventEmitter{constructor(){super(),this.portsNeeded=["gdbPort","swoPort","consolePort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`]}launchCommands(){return['interpreter-exec console "monitor _reset"',"target-download",'interpreter-exec console "monitor _reset"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor _reset"']}swoCommands(){return[]}serverExecutable(){return console.log("Getting Exec"),this.args.serverpath?this.args.serverpath:"win32"===n.platform()?"pegdbserver_console.exe":"pegdbserver_console"}serverArguments(){const e=this.ports.gdbPort;let t=[];return t.push("-startserver"),t.push("-singlesession"),t.push(`-device=${this.args.device}`),t.push(`-serverport=${e}`),this.args.ipAddress&&t.push(`-serverip=${this.args.ipAddress}`),this.args.rtos&&t.push(`-kernal=${this.args.rtos}`),this.args.interface&&t.push(`-interface=${this.args.interface}`),this.args.configFiles&&t.push(`-configfile=${this.args.configFiles[0]}`),this.args.serverArgs&&(t=t.concat(this.args.serverArgs)),t}initMatch(){return/All Servers Running/g}serverLaunchStarted(){}serverLaunchCompleted(){}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4),n=s(0),i=s(7).sync,o=["qemu-system-arm"];t.QEMUServerController=class extends n.EventEmitter{constructor(){super(),this.portsNeeded=["gdbPort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports[r.createPortName(this.args.targetProcessor)]}`]}launchCommands(){return["enable-pretty-printing"]}attachCommands(){return["enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor stop"','interpreter-exec console "monitor system_reset"']}swoCommands(){return[]}serverExecutable(){if(this.args.serverpath)return this.args.serverpath;for(const e in o)if(i(e))return e;return"qemu-system-arm"}serverArguments(){const e=this.ports.gdbPort;let t=["-cpu",this.args.cpu,"-machine",this.args.machine,"-nographic","-semihosting-config","enable=on,target=native","-gdb","tcp::"+e.toString(),"-S","-kernel",this.args.executable];return this.args.serverArgs&&(t=t.concat(this.args.serverArgs)),t}initMatch(){return null}serverLaunchStarted(){}serverLaunchCompleted(){}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);t.ExternalServerController=class extends r.EventEmitter{constructor(){super(),this.name="External",this.portsNeeded=[]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,s){return!1}initCommands(){return[`target-select extended-remote ${this.args.gdbTarget}`]}launchCommands(){return['interpreter-exec console "monitor reset halt"',"target-download",'interpreter-exec console "monitor reset halt"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}swoCommands(){return[]}restartCommands(){return['interpreter-exec console "monitor reset halt"']}serverExecutable(){return null}serverArguments(){return[]}initMatch(){return null}serverLaunchStarted(){}serverLaunchCompleted(){}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(5),n=s(2),i=s(1),o=s(19),a=s(3),c=s(11),u=s(20),l=/\n([0-9a-f]{8})\s([lg\ !])([w\ ])([C\ ])([W\ ])([I\ ])([dD\ ])([FfO\ ])\s(.*?)\s+([0-9a-f]+)\s([^\r\n]+)/gm,d=/\n <0>.*\(DW_TAG_compile_unit\)[\s\S]*?DW_AT_name[\s]*: (\(.*\):\s)?(.*)[\r\n]+([\s\S]*?)\n </gm,h=/DW_AT_comp_dir[\s]*: (\(.*\):\s)?(.*)[\r\n]+/m,p=!1,f={F:u.SymbolType.Function,f:u.SymbolType.File,O:u.SymbolType.Object," ":u.SymbolType.Normal},m={l:u.SymbolScope.Local,g:u.SymbolScope.Global," ":u.SymbolScope.Neither,"!":u.SymbolScope.Both};class g{constructor(e,t,s,r){this.toolchainPath=e,this.toolchainPrefix=t,this.executable=s,this.demangle=r,this.allSymbols=[],this.staticsByFile={},this.globalVars=[],this.globalFuncsMap={},this.staticVars=[],this.staticFuncsMap={},this.fileMap={}}loadSymbols(){try{let e="win32"!==n.platform()?`${this.toolchainPrefix}-objdump`:`${this.toolchainPrefix}-objdump.exe`;this.toolchainPath&&(e=i.normalize(i.join(this.toolchainPath,e)));const t=this.deSerializeFileMaps(this.executable),s=["--syms"];t||s.push("-Wi"),this.demangle&&s.push("-C");const c=o.tmpNameSync(),d=a.openSync(c,"w");r.spawnSync(e,[...s,this.executable],{stdio:["ignore",d,"ignore"]});a.closeSync(d);const h=this.readLinesAndFileMaps(c,!t),p=RegExp(l);let b,v=null;for(;null!==(b=p.exec(h));){"d"===b[7]&&"f"===b[8]&&(v=b[11]?g.NormalizePath(b[11].trim()):null);const e=f[b[8]],t=m[b[2]];let s=b[11].trim(),r=!1;s.startsWith(".hidden")&&(s=s.substring(7).trim(),r=!0);const n={address:parseInt(b[1],16),type:e,scope:t,section:b[9].trim(),length:parseInt(b[10],16),name:s,file:t===u.SymbolScope.Local?v:null,instructions:null,hidden:r};this.allSymbols.push(n)}this.categorizeSymbols(),t||this.serializeFileMaps(this.executable)}catch(e){}}categorizeSymbols(){for(const e of this.allSymbols){const t=e.scope,s=e.type;if(t!==u.SymbolScope.Local)s===u.SymbolType.Function?(e.scope=u.SymbolScope.Global,this.globalFuncsMap[e.name]=e):s===u.SymbolType.Object&&(t===u.SymbolScope.Global?this.globalVars.push(e):p&&console.log("SymbolTable: ignoring non local object: "+e.name));else if(e.file){if(s===u.SymbolType.Object)this.staticVars.push(e);else if(s===u.SymbolType.Function){const t=this.staticFuncsMap[e.name];t?t.push(e):this.staticFuncsMap[e.name]=[e]}}else s===u.SymbolType.Function?(e.scope=u.SymbolScope.Global,this.globalFuncsMap[e.name]=e):s===u.SymbolType.Object&&p&&console.log("SymbolTable: ignoring local object: "+e.name)}}printSyms(e){e=e||console.log;for(const t of this.allSymbols){let s=t.name;if(t.type===u.SymbolType.Function?s+=" (f)":t.type===u.SymbolType.Object&&(s+=" (o)"),t.file&&(s+=" (s)"),e(s),t.file){const s=this.fileMap[t.file];if(s)for(const t of s)e("\t"+t);else e("\tNoMap for? "+t.file)}}}printToFile(e){try{const t=a.openSync(e,"w");this.printSyms(e=>{a.writeSync(t,e),a.writeSync(t,"\n")}),a.closeSync(t)}catch(e){console.log("printSymsToFile: failed"+e)}}addToFileMap(e,t){t=g.NormalizePath(t);const s=this.fileMap[e]||[];return-1===s.indexOf(t)&&s.push(t),this.fileMap[e]=s,s}readLinesAndFileMaps(e,t){try{const s=Date.now();let r=a.readFileSync(e,{encoding:"utf8"});if(t){let e,t=0,n=r.length;const o=RegExp(d);for(;null!==(e=o.exec(r));){n>e.index&&(n=e.index);const s=g.NormalizePath(e[2]),r=i.basename(s);this.addToFileMap(r,r),this.addToFileMap(r,s),(e=RegExp(h).exec(e[3]))&&this.addToFileMap(r,e[2]+"/"+s),t++}const a=Date.now()-s;p&&console.log(`Runtime = ${a}ms`),n!==r.length&&(r=r.substring(0,n))}return r}catch(e){return""}}static createFileHash(e){try{const t=`${e=g.NormalizePath(e)}-${a.statSync(e).mtimeMs}-${n.userInfo().username}-v${g.schemaVer}`,s=c.createHash("sha256");return s.update(t),s.digest("hex")}catch(e){throw e}}static createFileMapCacheFileName(e){const t=g.createFileHash(e)+".json";return i.join(n.tmpdir(),"Cortex-Debug-"+t)}serializeFileMaps(e){try{const t=g.createFileMapCacheFileName(e),s=JSON.stringify(this.fileMap,null," ");a.writeFileSync(t,s,{encoding:"utf8"}),p&&console.log(`data saved to ${t}`)}catch(e){console.log(e.toString())}}deSerializeFileMaps(e){try{const t=g.createFileMapCacheFileName(e);if(!a.existsSync(t))return!1;const s=a.readFileSync(t,{encoding:"utf8"});this.fileMap=JSON.parse(s),p&&console.log(`data restored from ${t}`);try{const e=Date.now();a.utimesSync(t,e,e)}catch(e){}return!0}catch(e){return p&&console.log(e.toString()),!1}}getFunctionAtAddress(e){return this.allSymbols.find(t=>t.type===u.SymbolType.Function&&t.address<=e&&t.address+t.length>e)}getFunctionSymbols(){return this.allSymbols.filter(e=>e.type===u.SymbolType.Function)}getGlobalVariables(){return this.globalVars}getStaticVariables(e){e=g.NormalizePath(e);let t=this.staticsByFile[e];if(!t){t=[];for(const s of this.staticVars){const r=this.fileMap[s.file];r&&-1!==r.indexOf(e)&&t.push(s)}this.staticsByFile[e]=t}return t}getFunctionByName(e,t){if(t){t=g.NormalizePath(t);const s=this.staticFuncsMap[e];if(s){for(const e of s)if(e.file===t)return e;for(const e of s){const s=this.fileMap[e.file];if(s&&-1!==s.indexOf(t))return e}}}return this.globalFuncsMap[e]}static NormalizePath(e){return e?(e="win32"===n.platform()?e.replace(/\//g,"\\"):e.replace(/\\/g,"/"),e=i.normalize(e),"win32"===n.platform()&&(e=e.toLowerCase()),e):e}}g.schemaVer=0,t.SymbolTable=g}]);
//# sourceMappingURL=debugadapter.js.map